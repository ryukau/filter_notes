<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja" >

<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
      <meta name="dcterms.date" content="2025-02-18" />
      <title>antiderivative_antialiasing</title>

  <style>
    :root {
      --background-color: #ffffff;
      --foreground-color: #000000;
      --table-odd-background-color: #eeeeee;
      --link-color: #0000ee;
      --visited-color: #551a8b;
      --active-color: #ff0000;
      --border-color: #888888;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --background-color: #202020;
        --foreground-color: #eeeeee;
        --table-odd-background-color: #333333;
        --link-color: #88aaee;
        --visited-color: #dd77cc;
        --active-color: #ff6666;
        --border-color: #888888;
      }

      audio,
      code,
      img,
      .MathJax_ref,
      .sourceCode {
        /*
        0.8745 ~= 1 - 0x20 / 0xff.
        0x20 and 0xff are brightness of dark and light theme.
        */
        filter: invert(0.8745098039215686);
      }

      pre>code {
        filter: invert(0);
      }
    }

    body {
      max-width: 704px;
      margin: auto;
      padding: 32px 8px;

      background-color: var(--background-color);
      color: var(--foreground-color);
    }

    img {
      max-width: 100%;
    }

    video {
      max-width: 100%;
    }

    kbd {
      font-family: inherit;
      border-style: solid;
      border-width: 1px 2px 2px 1px;
      border-radius: 2px;
      padding: 4px;
      margin: 2px;
      line-height: calc(1em + 16px);
    }

    a {
      text-decoration: none;
    }

    :link {
      color: var(--link-color);
    }

    :visited {
      color: var(--visited-color);
    }

    :link:active,
    :visited:active {
      color: var(--active-color);
    }

    .header-anchor {
      color: var(--foreground-color);
    }

    .header-anchor:hover {
      color: var(--link-color);
    }

    .header-anchor:hover::after {
      display: inline-block;
      font-size: min(1em, 1rem);
      content: '(ã‚¯ãƒªãƒƒã‚¯ã§ã“ã“ã¸ãƒªãƒ³ã‚¯)';
      padding-left: 1em;
      color: var(--link-color);
    }

    h2 {
      border-left: solid 32px #000000;
      padding-left: 24px;
    }

    h3 {
      border-left: solid 20px #404040;
      padding-left: 16px;
    }

    h4 {
      font-size: 100%;
      border-left: solid 12px #606060;
      padding-left: 8px;
    }

    h5 {
      font-size: 90%;
      border-left: solid 8px #808080;
      padding-left: 8px;
    }

    h6 {
      font-size: 80%;
      border-left: solid 4px #a0a0a0;
      padding-left: 4px;
    }

    table {
      border-spacing: 0px;
      border-collapse: separate;
      border-left: 1px solid var(--border-color);
      border-right: 1px solid var(--border-color);
      border-top: 1px solid var(--border-color);
      border-bottom: hidden;
    }

    tr:nth-child(odd) {
      background: var(--table-odd-background-color);
    }

    tr:nth-child(even) {
      background: var(--background-color);
    }

    th {
      height: 2em;
      padding: 4px 1em 4px 1em;
      background: var(--background-color);
      border-bottom: 1px solid var(--border-color);
    }

    th:not(:first-child) {
      border-left: 1px solid var(--border-color);
    }

    td {
      height: 1.5em;
      padding: 4px 1em 4px 1em;
      border-bottom: 1px solid var(--border-color);
    }

    td:not(:first-child) {
      border-left: 1px solid var(--border-color);
    }

    dl {
      padding-left: 2em;
    }

    dt {
      font-weight: bold;
      border-bottom: 1px dashed #000000;
      margin-top: 2em;
    }

    dd {
      border-left: 1px dotted #000000;
      margin-left: 1em;
      padding-left: 1em;
    }

    audio {
      vertical-align: middle;
    }

    label {
      vertical-align: middle;
    }

    :not(.sourceCode)>pre {
      overflow: auto;
      border: 1px solid var(--border-color);
      padding: 8px;
    }

    div.sourceCode {
      overflow: auto;
      border: 1px solid var(--border-color);
      padding: 8px;
    }

    pre>code.sourceCode>span>a:first-child::before {
      border-right: 1px solid var(--border-color);
      padding-right: 1em;
      margin-right: 1em;
      text-decoration: none;
    }

    :not(pre)>code {
      color: #163eac;
    }

    li {
      margin: 8px;
    }

    summary:hover {
      background-color: var(--table-odd-background-color);
    }

    header {
      border-bottom: 1px var(--border-color) solid;
      padding: 0.5em;
      margin-bottom: 1em;
    }

    footer {
      border-top: 1px var(--border-color) solid;
      padding: 0.5em;
      margin-top: 1em;
    }


    canvas {
      /* image-rendering: pixelated; */
      display: inline-block;
      border-style: solid;
      border-width: 1px;
      border-color: #627f84;
    }

    .controlBlock {
      display: inline-block;
      width: 450px;
      text-align: left;
      vertical-align: top;
      margin-left: 4px;
    }

    input[type="button"] {
      background-color: #ffffff;
      border: 2px solid #aaaaaa;
      font-size: 16px;
      height: 32px;
    }

    input[type="button"]:hover {
      background-color: #ffffff;
      border: 2px solid #aaccff;
    }

    div.numberInput {
      display: block;
      white-space: nowrap;
    }

    div.numberInput:hover {
      background-color: #e0ecff;
    }

    .numberInputLabel {
      /* max 12 letter  */
      display: inline-block;
      margin: 0 8px 0 8px;
      text-align: left;
      vertical-align: middle;
      width: 100px;

      font-size: 10pt;
      font-family: 'Courier New', Courier, monospace;
    }

    .numberInputNumber {
      display: inline-block;
      vertical-align: middle;
      width: 120px;
    }

    .numberInputRange {
      display: inline-block;
      vertical-align: middle;
      width: 160px;
    }

    .pullDownMenu {
      display: inline-block;
      text-align: center;
    }

    .pullDownMenu:hover {
      background-color: #e0ecff;
    }

    select {
      background-color: #ffffff;
      border: 2px solid #aaaaaa;
      height: 24px;
      vertical-align: middle;
      font-size: 12px;
    }

    select:hover {
      background-color: #ffffff;
      border: 2px solid #aaccff;
    }

    span.math.inline a {
      color: #000000;
    }

    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #ffffff;
        color: #666666;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #666666;  padding-left: 4px; }
    div.sourceCode
      { color: #000000; background-color: #ffffff; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; text-decoration: underline; } /* Alert */
    code span.an { color: #666666; text-decoration: underline; } /* Annotation */
    code span.at { color: #333333; } /* Attribute */
    code span.bu { color: #000000; } /* BuiltIn */
    code span.cf { color: #666666; } /* ControlFlow */
    code span.ch { color: #b000b0; } /* Char */
    code span.cn { color: #000000; } /* Constant */
    code span.co { color: #008800; } /* Comment */
    code span.cv { color: #008800; } /* CommentVar */
    code span.do { color: #008800; } /* Documentation */
    code span.dt { color: #333333; } /* DataType */
    code span.dv { color: #0000ff; } /* DecVal */
    code span.er { color: #ffffff; background-color: #ff0000; } /* Error */
    code span.ex { color: #000000; } /* Extension */
    code span.fl { color: #0000ff; } /* Float */
    code span.im { color: #666666; } /* Import */
    code span.in { color: #666666; } /* Information */
    code span.kw { color: #666666; } /* Keyword */
    code span.op { color: #000000; } /* Operator */
    code span.ot { color: #000000; } /* Other */
    code span.pp { color: #666666; } /* Preprocessor */
    code span.sc { color: #b000b0; } /* SpecialChar */
    code span.ss { color: #b000b0; } /* SpecialString */
    code span.st { color: #b000b0; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #b000b0; } /* VerbatimString */
    code span.wa { color: #000000; background-color: #ffff00; text-decoration: underline; } /* Warning */
  </style>

    <script>
    MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script src="../lib/MathJax/es5/tex-chtml-full.js"
  type="text/javascript"></script>
    </head>

<body>
    <header>
    <p>
      ä½•ã‹ã‚ã‚Œã° <a href="https://github.com/ryukau/filter_notes">GitHub ã®ãƒªãƒã‚¸ãƒˆãƒª</a>ã« issue ã‚’ä½œã‚‹ã‹ ryukau@gmail.com ã¾ã§ãŠæ°—è»½ã«ã©ã†ãã€‚
    </p>
    <hr>
    <a href="../index.html">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«æˆ»ã‚‹</a>
        <p>
      Update: 2025-02-18
    </p>
            <details>
      <summary translate="yes">Table of Contents</summary>
      <nav id="TOC" role="doc-toc">
        <ul>
        <li><a href="#é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°"
        id="toc-é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°">é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°</a>
        <ul>
        <li><a href="#æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”"
        id="toc-æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”">æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”</a>
        <ul>
        <li><a href="#æ¬¡ã®-adaa" id="toc-æ¬¡ã®-adaa">1 æ¬¡ã® ADAA</a></li>
        <li><a href="#æ¬¡ã®-adaa-1" id="toc-æ¬¡ã®-adaa-1">2 æ¬¡ã®
        ADAA</a></li>
        <li><a href="#æ­ªã¿ã®é–¢æ•°-f-ã«ã¤ã„ã¦"
        id="toc-æ­ªã¿ã®é–¢æ•°-f-ã«ã¤ã„ã¦">æ­ªã¿ã®é–¢æ•° <span
        class="math inline">\(F\)</span> ã«ã¤ã„ã¦</a></li>
        <li><a href="#hardclip" id="toc-hardclip">hardclip</a></li>
        <li><a href="#halfrect" id="toc-halfrect">halfrect</a></li>
        <li><a href="#power" id="toc-power">power</a></li>
        <li><a href="#softclip2" id="toc-softclip2">softclip2</a></li>
        <li><a href="#softclipn" id="toc-softclipn">softclipN</a></li>
        <li><a href="#tanh" id="toc-tanh">tanh</a></li>
        <li><a href="#atan" id="toc-atan">atan</a></li>
        <li><a href="#algebraic" id="toc-algebraic">algebraic</a></li>
        <li><a href="#softplus" id="toc-softplus">softplus</a></li>
        <li><a href="#swish" id="toc-swish">swish</a></li>
        <li><a href="#exppoly" id="toc-exppoly">exppoly</a></li>
        <li><a href="#sinalgexp" id="toc-sinalgexp">sinalgexp</a></li>
        <li><a href="#sinatanexp"
        id="toc-sinatanexp">sinatanexp</a></li>
        <li><a href="#cosdecay" id="toc-cosdecay">cosdecay</a></li>
        <li><a href="#log1p" id="toc-log1p">log1p</a></li>
        <li><a href="#sinrunge" id="toc-sinrunge">sinrunge</a></li>
        <li><a href="#è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†"
        id="toc-è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†">è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†</a></li>
        <li><a href="#æ¬¡ä»¥ä¸Šã®-adaa" id="toc-æ¬¡ä»¥ä¸Šã®-adaa">3 æ¬¡ä»¥ä¸Šã®
        ADAA</a></li>
        </ul></li>
        <li><a href="#é€£ç¶šé ˜åŸŸã§-fir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰"
        id="toc-é€£ç¶šé ˜åŸŸã§-fir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰">é€£ç¶šé ˜åŸŸã§
        FIR ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰</a>
        <ul>
        <li><a href="#ill-condition"
        id="toc-ill-condition">Ill-condition</a></li>
        <li><a href="#tanh-1" id="toc-tanh-1">tanh</a></li>
        <li><a href="#åŠæ³¢æ•´æµ" id="toc-åŠæ³¢æ•´æµ">åŠæ³¢æ•´æµ</a></li>
        <li><a href="#ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—"
        id="toc-ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—">ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—</a></li>
        </ul></li>
        <li><a href="#é€£ç¶šé ˜åŸŸã§ã®-iir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•"
        id="toc-é€£ç¶šé ˜åŸŸã§ã®-iir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•">é€£ç¶šé ˜åŸŸã§ã®
        IIR ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•</a></li>
        <li><a href="#ãã®ä»–" id="toc-ãã®ä»–">ãã®ä»–</a>
        <ul>
        <li><a href="#c-ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª"
        id="toc-c-ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª">C++
        ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a>
        <ul>
        <li><a href="#boost" id="toc-boost">Boost</a></li>
        <li><a href="#cephes" id="toc-cephes">Cephes</a></li>
        <li><a href="#polylogarithm"
        id="toc-polylogarithm">Polylogarithm</a></li>
        </ul></li>
        <li><a href="#javascript-ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°"
        id="toc-javascript-ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°">JavaScript
        ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°</a></li>
        </ul></li>
        <li><a href="#å‚è€ƒæ–‡çŒ®" id="toc-å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></li>
        </ul></li>
        </ul>
      </nav>
    </details>
      </header>
  <h1 id="é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°"><a
  href="#é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°" class="header-anchor"
  aria-hidden="true">é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°</a></h1>
  <p>é€†å¾®åˆ†ã«ã‚ˆã‚‹æ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚° (ADAA: antiderivative
  antialiasing) ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
  <p>ADAA ã¯ã„ãã¤ã‹ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚ã“ã“ã§ã¯ä»¥ä¸‹ã® 3
  ã¤ã‚’æ‰±ã„ã¾ã™ã€‚</p>
  <ul>
  <li>é€£ç¶šé ˜åŸŸã§ FIR ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã€‚ (Parker
  ã‚‰ã«ã‚ˆã‚‹ã‚ªãƒªã‚¸ãƒŠãƒ«)</li>
  <li>æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã€‚ (Bilbao ã‚‰)</li>
  <li>é€£ç¶šé ˜åŸŸã§ã® IIR ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•ã€‚ (La Pastina ã‚‰)</li>
  </ul>
  <p>ã“ã®æ–‡ç« ã§ã¯ä¸»ã« Bilbao ã‚‰ã«ã‚ˆã‚‹æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã‚’æ‰±ã„ã¾ã™ã€‚
  Parker ã‚‰ã«ã‚ˆã‚‹æ‰‹æ³•ã«ã¤ã„ã¦ã¯ã€é€£ç¶šé ˜åŸŸã§ç•³ã¿è¾¼ã‚€ FIR
  ãƒ•ã‚£ãƒ«ã‚¿ã‚’ä¸‰è§’çª“ã‹ã‚‰ã‚³ã‚µã‚¤ãƒ³çª“ã«å¤‰ãˆã‚‹ã¨ã©ã†ãªã‚‹ã‹èª¿ã¹ã¾ã—ãŸã€‚ La
  Pastina ã‚‰ã«ã‚ˆã‚‹æ‰‹æ³•ã¯è‘—è€…ã‚‰ã«ã‚ˆã‚‹å®Ÿè£…ä¾‹ã®ç´¹ä»‹ã®ã¿ã§ã™ã€‚</p>
  <p>åŸºç¤ã¨ãªã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã«ã¤ã„ã¦ã¯ Parker ã‚‰ã®è«–æ–‡ãŒã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚<a
  href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a>ã®ç¯€ã«ãƒªãƒ³ã‚¯ã‚’å¼µã£ã¦ã„ã¾ã™ã€‚</p>
  <p>ä»¥ä¸‹ã¯ã€Œæœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”ã€ã®å†…å®¹ã®å®Ÿè£…ä¾‹ã¸ã®ãƒªãƒ³ã‚¯ã§ã™ã€‚</p>
  <ul>
  <li><a
  href="https://github.com/ryukau/filter_notes/blob/master/antiderivative_antialiasing/adaa.py">Python
  3 ã«ã‚ˆã‚‹å®Ÿè£… (github.com)</a></li>
  <li><a
  href="https://github.com/ryukau/filter_notes/blob/master/antiderivative_antialiasing/cpp/adaa.cpp">C++
  ã«ã‚ˆã‚‹å®Ÿè£… (github.com)</a></li>
  <li><a
  href="https://github.com/ryukau/UhhyouWebSynthesizers/blob/main/common/dsp/saturator.js">JavaScript
  ã«ã‚ˆã‚‹å®Ÿè£… (github.com)</a></li>
  </ul>
  <h2 id="æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”"><a
  href="#æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”" class="header-anchor"
  aria-hidden="true">æœ‰é™å·®åˆ†ã«åŸºã¥ãæ‰‹æ³•ã®ãƒ¬ã‚·ãƒ”</a></h2>
  <p>Bilbao, Esqueda, Parker, VÃ¤limÃ¤ki ã«ã‚ˆã‚‹ â€œ<a
  href="https://drive.google.com/file/d/1SaqbMpxitC8QECkF3OfzHu7cDCnmpzY7/view">Antiderivative
  antialiasing for memoryless nonlinearities</a>â€
  ã«åŸºã¥ãæ­ªã¿ã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ã“ã“ã§ã®æ­ªã¿ã¯ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ã‚„
  <span class="math inline">\(\tanh\)</span>
  ã®ã‚ˆã†ã«å…¥å‡ºåŠ›ã‚’å˜ç´”ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚¿ã‚¤ãƒ—ã®æ­ªã¿ã§ã™ã€‚</p>
  <p>0 æ¬¡ã® ADAA
  ã€ã¤ã¾ã‚Šã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚·ãƒ³ã‚°ãŒç„¡ã„æ­ªã¿ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã™ã“ã¨ã«ã—ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  y^{(0)}_n = {F}^{(0)} ({x}_{n}).
  \]</span></p>
  <p><span class="math inline">\(x\)</span> ã¯å…¥åŠ›ã€ <span
  class="math inline">\(y\)</span> ã¯å‡ºåŠ›ã€ <span
  class="math inline">\(F\)</span>
  ã¯æ­ªã¿ã®é–¢æ•°ã§ã™ã€‚ä¸‹ä»˜ãæ–‡å­—ã¯ã‚µãƒ³ãƒ—ãƒ«æ•°ã§è¡¨ã•ã‚ŒãŸç›¸å¯¾çš„ãªæ™‚é–“ã§ã€
  <span class="math inline">\(n\)</span> ã¯ç¾åœ¨æ™‚åˆ»ã€ <span
  class="math inline">\(n-1\)</span> ã¯ 1
  ã‚µãƒ³ãƒ—ãƒ«å‰ã®å€¤ã€ã¨ã„ã†æ„å‘³ã§ã™ã€‚ä¸Šä»˜ãæ–‡å­—ã® <span
  class="math inline">\((a)\)</span> ã¯ <span
  class="math inline">\(a\)</span> æ¬¡ã® ADAA
  ã§ã‚ã‚‹ã“ã¨ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ä»¥é™ã§ã¯å¼ã®è¦‹é€šã—ã‚’ã‚ˆãã™ã‚‹ãŸã‚ã«ã€ <span
  class="math inline">\({F}^{(a)} ({x}_{n}) = {F}^{(a)}_{n}\)</span>
  ã¨è¡¨è¨˜ã—ã¾ã™ã€‚</p>
  <p><span class="math inline">\(F\)</span>
  ã®ä¸­èº«ã«ã¤ã„ã¦ã¯å¾Œè¿°ã—ã¾ã™ã€‚</p>
  <h3 id="æ¬¡ã®-adaa"><a href="#æ¬¡ã®-adaa" class="header-anchor"
  aria-hidden="true">1 æ¬¡ã® ADAA</a></h3>
  <p>1 æ¬¡ã® ADAA ã¯ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã§ãã¾ã™ã€‚</p>
  <p><span class="math display">\[
  y^{(1)}_n = \frac{F^{(1)}_{n} - {F}^{(1)}_{n - 1} }{{x}_{n} - {x}_{n -
  1}}.
  \]</span></p>
  <p><span class="math inline">\({F}^{(1)}\)</span> ã¯ <span
  class="math inline">\({F}^{(0)}\)</span> ã‚’é€†å¾®åˆ†ã—ãŸé–¢æ•°ã§ã™ã€‚</p>
  <p>ä¸Šã®å¼ã¯ <span class="math inline">\({x}_{n} - {x}_{n - 1}\)</span>
  ãŒ 0 ã«è¿‘ã„ã¨ã€æµ®å‹•å°æ•°ç‚¹æ•°ã«ã‚ˆã‚‹è¨ˆç®—çµæœãŒ inf ã‚„ NaN
  ã¨ãªã‚‹å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å•é¡Œã®ã“ã¨ã‚’ ADAA é–¢é€£ã®è«–æ–‡ã§ã¯
  ill-condition ã¨å‘¼ã‚“ã§ã„ã¾ã™ã€‚ 1 æ¬¡ã® ADAA ã§ã¯ ill-condition
  ã¨ãªã‚‹ã¨ãã¯ä»¥ä¸‹ã®è¿‘ä¼¼å¼ã‚’ä»£ã‚ã‚Šã«ä½¿ã„ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  y^{(1)}_n \approx {F}^{(0)} \left( \frac{x_n + x_{n-1}}{2} \right).
  \]</span></p>
  <p>ä»¥ä¸‹ã¯ Python 3 ã«ã‚ˆã‚‹ 1 æ¬¡ã® ADAA ã®å®Ÿè£…ä¾‹ã§ã™ã€‚</p>
  <div class="sourceCode" id="cb1"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adaa1(x, f0, f1):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">    `x` : å…¥åŠ›ã® 1 æ¬¡å…ƒé…åˆ—ã€‚</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    `f0`: æ­ªã¿ã®é–¢æ•°ã€‚å¼ä¸­ã® F_0 ã€‚</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    `f1`: `f0` ã‚’é€†å¾®åˆ†ã—ãŸé–¢æ•°ã€‚å¼ä¸­ã® F_1 ã€‚</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    tolerance <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span><span class="op">**</span><span class="dv">24</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.zeros_like(x)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x[n]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        s0 <span class="op">=</span> f1(x0)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x1 <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> s1 <span class="op">==</span> <span class="dv">0</span>) <span class="kw">or</span> np.<span class="bu">abs</span>(x0 <span class="op">-</span> x1) <span class="op">&lt;</span> tolerance:</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            y[n] <span class="op">=</span> f0((x0 <span class="op">+</span> x1) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            y[n] <span class="op">=</span> (s0 <span class="op">-</span> s1) <span class="op">/</span> (x0 <span class="op">-</span> x1)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        s1 <span class="op">=</span> s0</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span></code></pre></div>
  <p><code>np.abs(x0 - x1) &lt; tolerance</code> ãŒ ill-condition
  ã‚’é¿ã‘ã‚‹ãŸã‚ã®åˆ†å²æ¡ä»¶ã§ã™ã€‚ã¾ãŸã€ <span
  class="math inline">\(F\)</span>
  ã®ä¸­èº«ã«ã‚ˆã£ã¦ã¯ãƒãƒƒãƒ—ãƒã‚¤ã‚ºãŒå‡ºãŸãŸã‚
  <code>x1 == 0 and s1 == 0</code> ã¨ã„ã†æ¡ä»¶ã‚‚è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚</p>
  <p>è¨ˆç®—é‡ã«ã¯æŒ¯ã‚Œå¹…ãŒã‚ã‚Šã¾ã™ã€‚æ¡ä»¶ãŒè‰¯ã‘ã‚Œã° 1 ã‚µãƒ³ãƒ—ãƒ«ã‚ãŸã‚Š
  <code>f1</code> ã‚’ 1 å›è¨ˆç®—ã™ã‚‹ã ã‘ã§æ¸ˆã¿ã¾ã™ã€‚ Ill-condition
  ã«å…¥ã‚‹ã¨ãã¯ 1 ã‚µãƒ³ãƒ—ãƒ«å½“ãŸã‚Šã§ <code>f1</code> ã‚’ 1 å›ã€
  <code>f0</code> ã‚’ 1 å›ã€è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ <span
  class="math inline">\(F\)</span> ã®è¨ˆç®—ãŒé‡ãŸã„ã¨ãã¯ãƒã‚¤ã‚ºã®ã‚µãƒ³ãƒ—ãƒ«
  &amp; ãƒ›ãƒ¼ãƒ«ãƒ‰ (S&amp;H)
  ãªã©ã‚’ãƒ†ã‚¹ãƒˆä¿¡å·ã¨ã—ã¦ä½¿ã„ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ç· ã‚åˆ‡ã‚Šã«ååˆ†é–“ã«åˆã†ã‹ã‚’ç¢ºèªã—ãŸã»ã†ãŒã‚ˆã•ãã†ã§ã™ã€‚</p>
  <h3 id="æ¬¡ã®-adaa-1"><a href="#æ¬¡ã®-adaa-1" class="header-anchor"
  aria-hidden="true">2 æ¬¡ã® ADAA</a></h3>
  <p>2 æ¬¡ã® ADAA ã¯ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã§ãã¾ã™ã€‚</p>
  <p><span class="math display">\[
  y^{(2)}_n =
  \frac{2}{{x}_{n} - {x}_{n - 2}} \left(
      \frac{{F}^{(2)}_{n} - {F}^{(2)}_{n - 1} }{{x}_{n} - {x}_{n - 1}}
    - \frac{{F}^{(2)}_{n - 1} - {F}^{(2)}_{n - 2}}{{x}_{n - 1} - {x}_{n
  - 2}}
  \right)
  \]</span></p>
  <p><span class="math inline">\({F}^{(2)}\)</span> ã¯ <span
  class="math inline">\({F}^{(1)}\)</span> ã‚’é€†å¾®åˆ†ã—ãŸé–¢æ•°ã§ã™ã€‚</p>
  <p>Ill-condition ã®ã¨ãã¯ä»¥ä¸‹ã®è¿‘ä¼¼å¼ã‚’ä½¿ã„ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  y^{(2)}_n &amp;\approx \frac{2}{\Delta_{n}} \left(
  {F}^{(1)}(\bar{x}_{n}) + \frac{{F}^{(2)}_{n-1} -
  {F}^{(2)}(\bar{x}_{n})}{\Delta_{n}} \right), \\
  \bar{x}_{n} &amp;= \frac{x_{n} + x_{n-2}}{2}, \quad \Delta_{n} =
  \bar{x}_{n} - x_{n-1}.
  \end{aligned}
  \]</span></p>
  <p>ã“ã® ill-condition ã®å¼ã¯ <span class="math inline">\(|\Delta_{n}|
  &lt; \epsilon\)</span> ã®ã¨ãã«ã€ã•ã‚‰ã« ill-condition
  ã¨ãªã‚Šã¾ã™ã€‚ã“ã®ã¨ãã¯ã•ã‚‰ã«åˆ†å²ã‚’è¨­ã‘ã¦ä»¥ä¸‹ã®è¿‘ä¼¼å¼ã‚’ä½¿ã„ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  y^{(2)}_{n} \approx {F}^{(0)} \left( \frac{\bar{x}_{n} + x_{n-1}}{2}
  \right).
  \]</span></p>
  <p>ä»¥ä¸‹ã¯ Python 3 ã«ã‚ˆã‚‹ 2 æ¬¡ã® ADAA ã®å®Ÿè£…ä¾‹ã§ã™ã€‚</p>
  <div class="sourceCode" id="cb2"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adaa2(x, f0, f1, f2):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    `x` : å…¥åŠ›ã® 1 æ¬¡å…ƒé…åˆ—ã€‚</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    `f0`: æ­ªã¿ã®é–¢æ•°ã€‚å¼ä¸­ã® F_0 ã€‚</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    `f1`: `f0` ã‚’é€†å¾®åˆ†ã—ãŸé–¢æ•°ã€‚å¼ä¸­ã® F_1 ã€‚</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    `f2`: `f1` ã‚’é€†å¾®åˆ†ã—ãŸé–¢æ•°ã€‚å¼ä¸­ã® F_2 ã€‚</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    tolerance <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span><span class="op">**</span><span class="dv">24</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.zeros_like(x)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    x2 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    s1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(x)):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x[n]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        f2_x1 <span class="op">=</span> f2(x1)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        s0 <span class="op">=</span> (</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            f1((x0 <span class="op">+</span> x1) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.<span class="bu">abs</span>(x0 <span class="op">-</span> x1) <span class="op">&lt;</span> tolerance</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> (f2(x0) <span class="op">-</span> f2_x1) <span class="op">/</span> (x0 <span class="op">-</span> x1)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x1 <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> x2 <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            y[n] <span class="op">=</span> f0((x0 <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x1 <span class="op">+</span> x2) <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> np.<span class="bu">abs</span>(x0 <span class="op">-</span> x2) <span class="op">&lt;</span> tolerance:</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            x_bar <span class="op">=</span> (x0 <span class="op">+</span> x2) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            delta <span class="op">=</span> x_bar <span class="op">-</span> x1</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.<span class="bu">abs</span>(delta) <span class="op">&lt;</span> tolerance:</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                y[n] <span class="op">=</span> f0((x_bar <span class="op">+</span> x1) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                y[n] <span class="op">=</span> (<span class="dv">2</span> <span class="op">/</span> delta) <span class="op">*</span> (f1(x_bar) <span class="op">+</span> (f2_x1 <span class="op">-</span> f2(x_bar)) <span class="op">/</span> delta) <span class="co"># ğŸ¤”</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            y[n] <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (s0 <span class="op">-</span> s1) <span class="op">/</span> (x0 <span class="op">-</span> x2)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        s1 <span class="op">=</span> s0</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>        x2 <span class="op">=</span> x1</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span></code></pre></div>
  <p><span class="math inline">\(F\)</span>
  ã®ä¸­èº«ã«ã‚ˆã£ã¦ã¯ãƒãƒƒãƒ—ãƒã‚¤ã‚ºãŒå‡ºãŸã®ã§ã€
  <code>x1 == 0 and x2 == 0</code>
  ã®åˆ†å²ã‚’åŠ ãˆã¦ã„ã¾ã™ã€‚ã“ã®åˆ†å²ã§ã®è¨ˆç®—ã¯
  <code>y[n] = f0(x0 / 4)</code> ã¨ç°¡ç•¥åŒ–ã§ãã¾ã™ã€‚</p>
  <p>è¨ˆç®—é‡ã®æŒ¯ã‚Œå¹…ã¯ã‚„ã‚„ã“ã—ã„çµ„ã¿åˆã‚ã›ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šã®å®Ÿè£…ã§ã¯ã€æœ€æ‚ªã®å ´åˆ
  ğŸ¤” ã«åˆ†å²ã—ã¦ <code>f2</code> ãŒ 3 å›ã€ <code>f1</code> ãŒ 1
  å›ã€è¨ˆç®—ã•ã‚Œã¾ã™ã€‚</p>
  <h3 id="æ­ªã¿ã®é–¢æ•°-f-ã«ã¤ã„ã¦"><a href="#æ­ªã¿ã®é–¢æ•°-f-ã«ã¤ã„ã¦"
  class="header-anchor" aria-hidden="true">æ­ªã¿ã®é–¢æ•° <span
  class="math inline">\(F\)</span> ã«ã¤ã„ã¦</a></h3>
  <p>æ­ªã¿ã®é–¢æ•° <span class="math inline">\(F\)</span>
  ã¯çŠ¶æ…‹ã‚’æŒãŸãªã„éç·šå½¢æ€§ (memoryless nonlinearities)
  ã«é™ã‚‰ã‚Œã¾ã™ã€‚ã¾ãŸã€é€†å¾®åˆ†å¯èƒ½ã§ãªã‘ã‚Œã° ADAA
  ã‚’é©ç”¨ã§ãã¾ã›ã‚“ã€‚å¤§ã¾ã‹ã«ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®æ•°å­¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å…¥ã£ã¦ã„ã‚‹ã‚ˆã†ãªé–¢æ•°ã§ã‚ã‚Œã°ã€ã»ã¼ä½¿ãˆã¾ã™ã€‚</p>
  <p>åŒºé–“é–¢æ•° (piecewise function)
  ã‚‚ä½¿ãˆã¾ã™ãŒã€é€†å¾®åˆ†ã—ãŸé–¢æ•°ãŒåŒºé–“ã®ã¤ãªãç›®ã§ã¤ãªãŒã‚‹ã‚ˆã†ã«ç©åˆ†å®šæ•°ã‚’æ±ºã‚ã¦ã‚„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚åŒºé–“é–¢æ•°ã¯ç©åˆ†å®šæ•°ã«ã‚ˆã£ã¦å¼ãŒç…©é›‘ã«ãªã‚ŠãŒã¡ã§ã™ã€‚</p>
  <p>ä»¥é™ã§ã¯ <span class="math inline">\(J^n\)</span> ã§ <span
  class="math inline">\(n\)</span>
  å›ã®é€†å¾®åˆ†ã‚’è¡¨ã—ã¾ã™ã€‚ã¾ãŸã€ä»¥ä¸‹ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°ãŒç¾ã‚Œã¾ã™ã€‚</p>
  <ul>
  <li><span class="math inline">\(\operatorname{Li}_2\)</span>:
  dilogarithm</li>
  <li><span class="math inline">\(\operatorname{Li}_3\)</span>:
  trilogarithm</li>
  <li><span class="math inline">\(\Gamma(a, x)\)</span>: upper
  incomplete gamma function</li>
  <li><span class="math inline">\(\operatorname{Si}\)</span>: sine
  integral</li>
  <li><span class="math inline">\(\operatorname{Ci}\)</span>: cosine
  integral</li>
  <li><span class="math inline">\({}_3 F_3\)</span>: hypergeometric
  function</li>
  </ul>
  <h3 id="hardclip"><a href="#hardclip" class="header-anchor"
  aria-hidden="true">hardclip</a></h3>
  <p>åˆ†å²ã®å¢ƒç•Œã¨ãªã‚‹ <span class="math inline">\(x = \pm 1\)</span>
  ã®ã¨ãã«ã€åˆ†å²ã®ä¸¡å´ã®å¼ãŒåŒã˜å€¤ã«ãªã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ç©åˆ†å®šæ•°ã¯
  <span class="math inline">\(J^1\)</span> ã§ <span
  class="math inline">\(1/2\)</span> ã€ <span
  class="math inline">\(J^2\)</span> ã§ <span
  class="math inline">\(1/6\)</span> ã¨ãªã‚Šã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{hardclip}}(x) &amp;= \begin{cases}
    x &amp; |x| &lt; 1 \\
    \mathrm{sgn}(x) &amp; \text{otherwise}
  \end{cases} \\
  J^1 f_{\mathrm{hardclip}}(x) &amp;= \begin{cases}
    x^2/2 &amp; |x| &lt; 1 \\
    \mathrm{sgn}(x) \cdot x - 1/2 &amp; \text{otherwise}
  \end{cases} \\
  J^2 f_{\mathrm{hardclip}}(x) &amp;= \begin{cases}
    x^3/6 &amp; |x| &lt; 1 \\
    \mathrm{sgn}(x) \cdot (x^2/2 + 1/6) - x/2 &amp; \text{otherwise}
  \end{cases}\\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã€‚</p>
  <div class="sourceCode" id="cb3"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sympy.Symbol(<span class="st">&quot;x&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>J0_case0 <span class="op">=</span> x</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>J0_case1 <span class="op">=</span> sympy.sign(x)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>J1_case0 <span class="op">=</span> sympy.integrate(J0_case0, x)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>J1_case1 <span class="op">=</span> sympy.integrate(J0_case1, x)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>J1_case1 <span class="op">+=</span> J1_case0.subs(x, <span class="dv">1</span>) <span class="op">-</span> J1_case1.subs(x, <span class="dv">1</span>)  <span class="co"># ç©åˆ†å®šæ•°</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>J2_case0 <span class="op">=</span> sympy.integrate(J1_case0, x)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>J2_case1 <span class="op">=</span> sympy.integrate(J1_case1, x)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>J2_case1 <span class="op">+=</span> J2_case0.subs(x, <span class="dv">1</span>) <span class="op">-</span> J2_case1.subs(x, <span class="dv">1</span>)  <span class="co"># ç©åˆ†å®šæ•°</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> expr <span class="kw">in</span> [J0_case0, J0_case1, J1_case0, J1_case1, J2_case0, J2_case1]:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;---</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    sympy.pprint(expr)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code></pre></div>
  <p>å®Ÿè£…ä¾‹ã€‚ <code>a if c else b</code> ã§åˆ†å²ã‚’ 1 è¡Œã«æŠ¼ã—è¾¼ã‚ã‚‹ãŒã€ C
  è¨€èªãªã©ã® <code>c ? a : b</code>
  ã¸ã¨ç§»æ¤ã™ã‚‹ã¨ãã«é–“é•ãˆã‚„ã™ã„ã®ã§é¿ã‘ã¦ã„ã‚‹ã€‚</p>
  <div class="sourceCode" id="cb4"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hardclipJ0(x):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.clip(x, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hardclipJ1(x):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    absed <span class="op">=</span> np.<span class="bu">abs</span>(x)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> absed <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">*</span> x <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> absed <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hardclipJ2(x):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.<span class="bu">abs</span>(x) <span class="op">&lt;</span> <span class="dv">1</span>:</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x <span class="op">*</span> x <span class="op">*</span> x <span class="op">/</span> <span class="dv">6</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">*</span> x <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">6</span>) <span class="op">*</span> np.sign(x) <span class="op">-</span> (x <span class="op">/</span> <span class="dv">2</span>)</span></code></pre></div>
  </details>
  <h3 id="halfrect"><a href="#halfrect" class="header-anchor"
  aria-hidden="true">halfrect</a></h3>
  <p>hardclip ã¨åŒæ§˜ã§ã™ãŒã€ç©åˆ†å®šæ•°ã¯ã™ã¹ã¦ 0 ã§ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{halfrect}}(x) &amp;= \begin{cases}
    0 &amp; x \leq 0 \\
    x &amp; \text{otherwise}
  \end{cases} \\
  J^1 f_{\mathrm{halfrect}}(x) &amp;= \begin{cases}
    0 &amp; x \leq 0 \\
    x^2/2 &amp; \text{otherwise}
  \end{cases} \\
  J^2 f_{\mathrm{halfrect}}(x) &amp;= \begin{cases}
    0 &amp; x \leq 0 \\
    x^3/6 &amp; \text{otherwise}
  \end{cases}\\
  \end{aligned}
  \]</span></p>
  <h3 id="power"><a href="#power" class="header-anchor"
  aria-hidden="true">power</a></h3>
  <p>å‡ºåŠ›ãŒå®Ÿæ•°ã‹ã¤ã€è² ã®å€¤ãŒå‡ºã¦ã»ã—ã„ã®ã§ã€å®Ÿè£…ã§ã¯ <span
  class="math inline">\(J^0 f = \mathrm{sgn}(x) \cdot |x|^Î²\)</span>
  ã¨ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸ <span class="math inline">\(\beta &lt; 0\)</span>
  ã®ã¨ãã®å‹•ä½œã¯æ¤œè¨¼ã—ã¦ã„ã¾ã›ã‚“ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{power}}(x) &amp;= x^Î², \quad x \geq 0\\
  J^1 f_{\mathrm{power}}(x) &amp;= \begin{cases}
    \dfrac{x^{Î² + 1}}{Î² + 1} &amp; \beta \neq -1\\
    \log(x) &amp; \text{otherwise}
  \end{cases} \\
  J^2 f_{\mathrm{power}}(x) &amp;= \begin{cases}
    \dfrac{x^{Î² + 2}}{Î²^2 + 3 Î² + 2} &amp; \beta \neq -1\\
    x (\log(x) - 1) &amp; \text{otherwise}
  \end{cases}\\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb5"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Maxima */</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="cn">x</span>^|Î²|;</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>));</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>));</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯å‡ºåŠ›ã§ã™ã€‚æ¡ä»¶ã‚’ã„ãã¤ã‹èã‹ã‚ŒãŸã®ã§ç­”ãˆã¦ã„ã¾ã™ã€‚</p>
  <pre><code>(J0)    x^Î²
&quot;Is &quot;Î²&quot; equal to &quot;-1&quot;?&quot;no;
(J1)    x^(Î²+1)/(Î²+1)
&quot;Is &quot;Î²+1&quot; equal to &quot;-1&quot;?&quot;no;
(J2)    x^(Î²+2)/(Î²^2+3*Î²+2)</code></pre>
  </details>
  <h3 id="softclip2"><a href="#softclip2" class="header-anchor"
  aria-hidden="true">softclip2</a></h3>
  <p>è©³ç´°ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
  <ul>
  <li><a
  href="https://ryukau.github.io/filter_notes/limiter/limiter.html#%E3%82%BD%E3%83%95%E3%83%88%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97">limiter
  - ã‚½ãƒ•ãƒˆã‚¯ãƒªãƒƒãƒ—</a></li>
  </ul>
  <p>ç©åˆ†å®šæ•°ã«ã‚ˆã£ã¦ç…©é›‘ãªå½¢ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{softclip2}}(x) &amp;= \begin{cases}
    x &amp; \text{if}\ |x| &lt; a_1
      &amp;&amp; \text{(linear region)}\\
    h + \mathrm{sgn}(x) \dfrac{0.25 (a_2 - |x|)^2}{a_1 - h}  &amp;
  \text{if}\ a_1 \leq|x| &lt; a_2
      &amp;&amp; \text{(2nd order region)}\\
    h &amp; \text{if}\ a_2 \leq |x|
      &amp;&amp; \text{(clipping region)}\\
  \end{cases}
  \\
  a_1 &amp;= rh, \qquad a_2 = 2h - a_1.
  \\\\
  J^1 f_{\mathrm{softclip2}}(x) &amp;= \begin{cases}
  \displaystyle
    \frac{x^2}{2}
    &amp; \text{if}\ |x| &lt; a_1
  \\[1em]
  \displaystyle
    a_1 \left( \frac{a_1}{2} - h \right)
    + h x
    + \frac{(a_1 - a_2)^3 - (x - a_2)^3}{12 (h - a_1)}
    &amp; \text{if}\ a_1 \leq|x| &lt; a_2
  \\[1em]
  \displaystyle
    a_1 \left(\frac{a_1}{2} - h\right)
    + h x
    + \frac{\left(a_1 - a_2\right)^3}{12 (h - a_1)}
    &amp; \text{if}\ a_2 \leq |x|
    \end{cases}
  \\
  J^2 f_{\mathrm{softclip2}}(x) &amp;= \begin{cases}
  \displaystyle
    \frac{x^3}{6}
    &amp; \text{if}\ |x| &lt; a_1
  \\[1em]
  \displaystyle
    \frac{a_1^2 (3 x - 2 a_1)}{6}
    + \frac{h (x - a_1)^2}{2}
    - \frac{
      (x - a_1)^2 \left(
        - 4 a_2 (a_1 - a_2 + x)
        + 2 (a_1 - a_2)^2
        + (a_1 + x)^2
      \right)
    }{48 (h - a_1)}
    &amp; \text{if}\ a_1 \leq|x| &lt; a_2
  \\[1em]
  \displaystyle
    \frac{a_1^2 (3 x - 2 a_1)}{6}
    + \frac{h (x - a_1)^2}{2}
    + \frac{(a_1 - a_2)^3 \left(- 3 a_1 - a_2 + 4 x\right)}{48 (h -
  a_1)}
  &amp; \text{if}\ a_2 \leq |x|
  \end{cases}
  \\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb7"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x, h, a_1, a_2 <span class="op">=</span> sympy.symbols(<span class="st">&quot;x, h, a_1, a_2&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># J:       |x| &lt; a1,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># K: a1 &lt;= |x| &lt; a2,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># L: a2 &lt;= |x|.</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>J0 <span class="op">=</span> x</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>K0 <span class="op">=</span> h <span class="op">+</span> (a_2 <span class="op">-</span> x) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> (<span class="dv">4</span> <span class="op">*</span> (a_1 <span class="op">-</span> h))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>L0 <span class="op">=</span> h</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>J1 <span class="op">=</span> sympy.integrate(J0, x)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>K1 <span class="op">=</span> sympy.integrate(K0, x)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>L1 <span class="op">=</span> sympy.integrate(L0, x)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>K1 <span class="op">+=</span> J1.subs(x, a_1) <span class="op">-</span> K1.subs(x, a_1)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>L1 <span class="op">+=</span> K1.subs(x, a_2) <span class="op">-</span> L1.subs(x, a_2)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>J2 <span class="op">=</span> sympy.integrate(J1, x)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>K2 <span class="op">=</span> sympy.integrate(K1, x)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>L2 <span class="op">=</span> sympy.integrate(L1, x)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>K2 <span class="op">+=</span> J2.subs(x, a_1) <span class="op">-</span> K2.subs(x, a_1)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>K2 <span class="op">+=</span> J2.subs(x, a_2) <span class="op">-</span> K2.subs(x, a_2)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cases <span class="kw">in</span> [[J0, K0, L0], [J1, K1, L1], [J2, K2, L2]]:</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;---&quot;</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> expr <span class="kw">in</span> cases:</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.simplify(expr)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        sympy.pprint(expr)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span></code></pre></div>
  </details>
  <h3 id="softclipn"><a href="#softclipn" class="header-anchor"
  aria-hidden="true">softclipN</a></h3>
  <p>ä»¥ä¸‹ã¯ softclipN ã®ä»•æ§˜ã§ã™ã€‚</p>
  <figure>
  <img src="img/clipping.svg" alt="Input-output plot of arbitrary order polynomial softclip." style="padding-bottom: 12px;"/>
  </figure>
  <p>å¼ã®ç°¡ç•¥åŒ–ã®ãŸã‚ã« <span class="math inline">\(\beta \geq
  0\)</span> ã¨ã—ã¾ã™ã€‚è² ã®å€¤ã‚’ä½¿ã†ã¨ãã¯ã€ <span
  class="math inline">\(J^1\)</span> ã®ã¨ãã« <span
  class="math inline">\(\beta = -1\)</span> ã€ <span
  class="math inline">\(J^2\)</span> ã®ã¨ãã« <span
  class="math inline">\(\beta=-2\)</span> ã§åˆ†å²ãŒç¾ã‚Œã¾ã™ãŒã€ã“ã“ã§ã¯
  <span class="math inline">\(\beta &gt; 0\)</span>
  ã¨ã—ã¦ç„¡è¦–ã—ã¦ã„ã¾ã™ã€‚å› æ•°åˆ†è§£ (factorization) ã¯ SymPy
  ã®å‡ºåŠ›ã‚’ã‚‚ã¨ã«æ‰‹ã§è¡Œã£ãŸã®ã§æœ€é©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{softclipN}}(x) &amp;= \begin{cases}
  x &amp; x \leq r_c\\
  C + A (x_c - x)^\beta &amp; r_c &lt; x &lt; x_c \\
  C + A (x_c - x_s)^\beta + S (x - x_s) &amp; x_c \leq x \\
  \end{cases}
  \\
  x_c &amp;= r_c + \beta (C - r_c),\quad
  A = \frac{r_c - C}{(x_c - r_c)^\beta},\quad
  x_s = x_c - \left( -\frac{S}{A \beta} \right)^{1/(\beta - 1)}.
  \\\\
  J^1 f_{\mathrm{softclipN}}(x) &amp;= \begin{cases}
  \dfrac{x^2}{2}
  &amp; x \leq r_c \\[1em]
  \displaystyle
  \frac{A \left(\left(x_{c} - r_{c}\right)^{1 + Î²} - \left(x_{c} -
  x\right)^{1 + Î²}\right)}{1 + Î²}
  + C \left(x - r_{c}\right)
  + \frac{r_{c}^{2}}{2}
  &amp; r_c &lt; x &lt; x_c \\[1em]
  \displaystyle
  \frac{A \left(x_{c} - r_{c}\right)^{1 + Î²}}{1 + Î²}
  + C \left(x_{c} - r_{c}\right)
  + \frac{S \left(x^{2} - x_{c}^{2}\right)}{2}
  + \frac{r_{c}^{2}}{2}
  + \left(x - x_{c}\right) \left(A \left(x_{c} - x_{s}\right)^{Î²} + C -
  S x_{s}\right)
  &amp; x_c \leq x \\[1em]
  \end{cases}
  \\
  J^2 f_{\mathrm{softclipN}}(x) &amp;= \begin{cases}
  \dfrac{x^3}{6}
  &amp; x \leq r_c \\[1em]
  \displaystyle
  A \left(
    \frac{\left(x_{c} - x\right)^{2 + Î²} - \left(x_{c} - r_{c}\right)^{2
  + Î²}}{\left(1 + Î²\right) \left(2 + Î²\right)} + \frac{\left(x_{c} -
  r_{c}\right)^{1 + Î²} \left(x - r_{c}\right)}{1 + Î²}
  \right)
  + \frac{C \left(x - r_{c}\right)^{2}}{2}
  + r_{c}^{2} \left(\frac{x}{2} - \frac{r_{c}}{3}\right)
  &amp; r_c &lt; x &lt; x_c \\[1em]
  \displaystyle
  \frac{A \left(x_{c} - r_{c}\right)^{2 + Î²} \left(1 - \frac{1}{2 +
  Î²}\right)}{1 + Î²}
  + \frac{C \left(x_{c} - r_{c}\right)^{2}}{2}
  + \frac{S \left(x^{3} - x_{c}^{3}\right)}{6}
  + r_{c}^{2} \left(\frac{x_{c}}{2} - \frac{r_{c}}{3}\right)
  + \left(x - x_{c}\right) \left(
    A \left(\frac{\left(x_{c} - r_{c}\right)^{1 + Î²}}{1 + Î²} - x_{c}
  \left(x_{c} - x_{s}\right)^{Î²}\right)
    - C r_{c}
    + S x_{c} \left(x_{s} - \frac{x_{c}}{2}\right)
    + \frac{r_{c}^{2}}{2}
    + \frac{x + x_{c}}{2} \left(A \left(x_{c} - x_{s}\right)^{Î²} + C - S
  x_{s}\right)
  \right)
  &amp; x_c \leq x \\[1em]
  \end{cases}
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb8"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x, A, C, r_c, x_c, x_s, S <span class="op">=</span> sympy.symbols(<span class="st">&quot;x, A, C,r_c, x_c, x_s, S&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># `positive=True` ã§ Î² = -1, Î² = -2 ã®ã¨ãã®åˆ†å²ã‚’é™¤å»ã—ã¦ã„ã‚‹ã€‚</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>Î² <span class="op">=</span> sympy.Symbol(<span class="st">&quot;Î²&quot;</span>, real<span class="op">=</span><span class="va">True</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># J:        |x| &lt;= r_c,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># K: r_c &lt;  |x| &lt;  x_c,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># L: x_c &lt;= |x|.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>J0 <span class="op">=</span> x</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>K0 <span class="op">=</span> C <span class="op">+</span> A <span class="op">*</span> (x_c <span class="op">-</span> x) <span class="op">**</span> Î²</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>L0 <span class="op">=</span> C <span class="op">+</span> A <span class="op">*</span> (x_c <span class="op">-</span> x_s) <span class="op">**</span> Î² <span class="op">+</span> S <span class="op">*</span> (x <span class="op">-</span> x_s)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>J1 <span class="op">=</span> sympy.integrate(J0, x)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>K1 <span class="op">=</span> sympy.integrate(K0, x)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>L1 <span class="op">=</span> sympy.integrate(L0, x)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>K1 <span class="op">+=</span> J1.subs(x, r_c) <span class="op">-</span> K1.subs(x, r_c)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>L1 <span class="op">+=</span> K1.subs(x, x_c) <span class="op">-</span> L1.subs(x, x_c)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>J2 <span class="op">=</span> sympy.integrate(J1, x)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>K2 <span class="op">=</span> sympy.integrate(K1, x)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>L2 <span class="op">=</span> sympy.integrate(L1, x)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>K2 <span class="op">+=</span> J2.subs(x, r_c) <span class="op">-</span> K2.subs(x, r_c)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>L2 <span class="op">+=</span> K2.subs(x, x_c) <span class="op">-</span> L2.subs(x, x_c)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cases <span class="kw">in</span> [[J0, K0, L0], [J1, K1, L1], [J2, K2, L2]]:</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;---&quot;</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> expr <span class="kw">in</span> cases:</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.simplify(expr)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>        sympy.pprint(expr)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯ C++ ã«ã‚ˆã‚‹ <span class="math inline">\(J^0
  f_{\mathrm{softclipN}}\)</span> ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å®Ÿè£…ã§ã™ã€‚</p>
  <div class="sourceCode" id="cb9"><pre
  class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span> processJ0<span class="op">(</span><span class="dt">float</span> x0<span class="op">)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// æ•°å¼ã¨ã®å¯¾å¿œ: C = clipY, R = ratio, A = scale, Î² = order, S: slope.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">float</span> absed <span class="op">=</span> <span class="bu">std::</span>fabs<span class="op">(</span>x0<span class="op">);</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">float</span> rc <span class="op">=</span> C <span class="op">*</span> R<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>absed <span class="op">&lt;=</span> rc<span class="op">)</span> <span class="cf">return</span> x0<span class="op">;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">float</span> xc <span class="op">=</span> rc <span class="op">+</span> beta <span class="op">*</span> <span class="op">(</span>C <span class="op">-</span> rc<span class="op">);</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">float</span> A <span class="op">=</span> <span class="op">(</span>rc <span class="op">-</span> C<span class="op">)</span> <span class="op">/</span> <span class="bu">std::</span>pow<span class="op">(</span>xc <span class="op">-</span> rc<span class="op">,</span> beta<span class="op">);</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">float</span> xs <span class="op">=</span> xc <span class="op">-</span> <span class="bu">std::</span>pow<span class="op">(-</span>S <span class="op">/</span> <span class="op">(</span>A <span class="op">*</span> beta<span class="op">),</span> <span class="dt">float</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span>beta <span class="op">-</span> <span class="dt">float</span><span class="op">(</span><span class="dv">1</span><span class="op">)));</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> absed <span class="op">&lt;</span> xs</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> <span class="bu">std::</span>copysign<span class="op">(</span>C <span class="op">+</span> A <span class="op">*</span> <span class="bu">std::</span>pow<span class="op">(</span>xc <span class="op">-</span> absed<span class="op">,</span> beta<span class="op">),</span> x0<span class="op">)</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="bu">std::</span>copysign<span class="op">(</span>S <span class="op">*</span> <span class="op">(</span>absed <span class="op">-</span> xs<span class="op">)</span> <span class="op">+</span> C <span class="op">+</span> A <span class="op">*</span> <span class="bu">std::</span>pow<span class="op">(</span>xc <span class="op">-</span> xs<span class="op">,</span> beta<span class="op">),</span> x0<span class="op">);</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
  </details>
  <h3 id="tanh"><a href="#tanh" class="header-anchor"
  aria-hidden="true">tanh</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{tanh}}(x) &amp;= \tanh{\left(x \right)}\\
  J^1 f_{\mathrm{tanh}}(x) &amp;= \log{\left( \cosh{(x)}\right) }\\
  J^2 f_{\mathrm{tanh}}(x) &amp;= x \log \left( \frac{\cosh(x)}{e^{2 x}
  + 1} \right) + \frac{x^2 - \mathrm{Li}_2(-e^{2 x})}{2}\\
  \\
  \text{where} \quad \mathrm{Li}_2(z) &amp;= \int_1^z \frac{\log(t)}{1 -
  t} dt.
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\(\mathrm{Li}_2\)</span> ã¯ <a
  href="https://mathworld.wolfram.com/Dilogarithm.html">dilogarithm</a>
  ã¨å‘¼ã°ã‚Œã‚‹é–¢æ•°ã§ã™ã€‚</p>
  <p>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã£ã¦ã¯ <span
  class="math inline">\(\mathrm{Li}_2\)</span> ã®ä»£ã‚ã‚Šã« <a
  href="https://mathworld.wolfram.com/SpencesFunction.html">Spenceâ€™s
  function</a> ã®ã¿ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ Spenceâ€™s function ã‚’
  <span class="math inline">\(\operatorname{Sp}\)</span> ã¨ã™ã‚‹ã¨ã€
  <span class="math inline">\(\mathrm{Sp}(x) = -\mathrm{Li}_2
  (-x)\)</span> ã¨ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã° Maxima ã§ <a
  href="https://flex.phys.tohoku.ac.jp/texi/maxima/maxima_14.html#IDX463"><code>-li[2](-z)</code></a>
  ã¨ãªã‚‹ã¨ãã€ SciPy ã§ã¯ <a
  href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.spence.html"><code>spence(z)</code></a>
  ã¨ãªã‚Šã¾ã™ã€‚ Spenceâ€™s function ã¯ <a
  href="https://netlib.org/cephes/">cephes</a> ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€
  <span class="math inline">\(\mathrm{Li}_2\)</span>
  ã‚ˆã‚Šã‚‚ã‚ˆãç§»æ¤ã•ã‚Œã¦ã„ã‚‹ã®ã‹ã¨æ€ã„ã¾ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb10"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Maxima */</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="fu">tanh</span>(<span class="cn">x</span>);</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>));</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>));</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯å‡ºåŠ›ã§ã™ã€‚</p>
  <pre><code>(J0)    tanh(x)
(J1)    log(cosh(x))
(J2)    (2*x*log(cosh(x))-2*x*log(%e^(2*x)+1)-li[2](-%e^(2*x))+x^2)/2</code></pre>
  </details>
  <h3 id="atan"><a href="#atan" class="header-anchor"
  aria-hidden="true">atan</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{atan}}(x) &amp;= \arctan(x)\\
  J^1 f_{\mathrm{atan}}(x) &amp;= x \arctan(x) - \frac{\log(x^{2} +
  1)}{2}\\
  J^2 f_{\mathrm{atan}}(x) &amp;= \frac{x - x \log(x^{2}+ 1) - (1 -
  x^{2})\arctan(x)}{2}\\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb12"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Maxima */</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="fu">atan</span>(<span class="cn">x</span>);</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>));</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>));</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯å‡ºåŠ›ã§ã™ã€‚</p>
  <pre><code>(J0)    atan(x)
(J1)    -((log(x^2+1)-2*x*atan(x))/2)
(J2)    -((x*log(x^2+1)+(1-x^2)*atan(x)-x)/2)</code></pre>
  </details>
  <h3 id="algebraic"><a href="#algebraic" class="header-anchor"
  aria-hidden="true">algebraic</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{algebraic}}(x) &amp;= \frac{x}{z + 1}\\
  J^1 f_{\mathrm{algebraic}}(x) &amp;= z - w\\
  J^2 f_{\mathrm{algebraic}}(x) &amp;= \mathrm{sgn}(x) \cdot \left(
    z \left(\frac{z}{2} - w + 1 \right) - w
  \right)\\
  \\
  \text{where} \quad z &amp;= |x|, \quad w = \log(z + 1).
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\(w\)</span> ã®è¨ˆç®—ã«ã¯
  <code>log1p</code> ãŒä½¿ãˆã¾ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã¾ã™ã€‚ä¸Šã®å¼ã¯è¤‡ç´ æ•°ã‚’ç„¡è¦–ã—ã¦ã„ã‚‹ã®ã§ SymPy
  ã®è§£ã¨ã¯ä¸€è‡´ã—ã¦ã„ã¾ã›ã‚“ã€‚</p>
  <div class="sourceCode" id="cb14"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sympy.Symbol(<span class="st">&quot;x&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>J0 <span class="op">=</span> x <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> sympy.Abs(x))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>J1 <span class="op">=</span> sympy.integrate(J0, x)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>J2 <span class="op">=</span> sympy.integrate(J1, x)</span></code></pre></div>
  </details>
  <h3 id="softplus"><a href="#softplus" class="header-anchor"
  aria-hidden="true">softplus</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{softplus}}(x) &amp;= \log(e^x + 1) \\
  J^1 f_{\mathrm{softplus}}(x) &amp;= - \mathrm{Li}_2 (-e^x) \\
  J^2 f_{\mathrm{softplus}}(x) &amp;= - \mathrm{Li}_3 (-e^x) \\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Wolfram Alpha ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb15"><pre
  class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>J0 <span class="ex">=</span> <span class="fu">log</span><span class="op">[</span><span class="fu">exp</span><span class="op">[</span><span class="fu">x</span><span class="op">]</span> <span class="sc">+</span> <span class="dv">1</span><span class="op">]</span>;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>J1 <span class="ex">=</span> antiderivative<span class="op">[</span><span class="fu">log</span><span class="op">[</span><span class="fu">exp</span><span class="op">[</span><span class="fu">x</span><span class="op">]</span> <span class="sc">+</span> <span class="dv">1</span><span class="op">],</span> <span class="fu">x</span><span class="op">]</span>;</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>J2 <span class="ex">=</span> antiderivative<span class="op">[</span><span class="sc">-</span><span class="fu">polylog</span><span class="op">[</span><span class="dv">2</span><span class="op">,</span> <span class="sc">-</span><span class="fu">exp</span><span class="op">[</span><span class="fu">x</span><span class="op">]],</span> <span class="fu">x</span><span class="op">]</span>;</span></code></pre></div>
  <p><span class="math inline">\(\mathrm{Li}_3\)</span>
  ã¯ã‚ã¾ã‚Šä½¿ã‚ã‚Œãªã„é–¢æ•°ãªã®ã‹ SciPy ã§ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ C++ ã‹
  Fortran ã§ã‚ã‚Œã° <a
  href="https://github.com/Expander/polylogarithm">Expander/polylogarithm</a>
  ãŒä½¿ãˆã¾ã™ã€‚ Python 3 ã§ã¯ <a
  href="https://www.mpmath.org/doc/current/functions/zeta.html#polylog"><code>mpmath.polylog</code></a>
  ãŒä½¿ãˆã¾ã™ãŒã€ä»»æ„ç²¾åº¦ãªã®ã§è¨ˆç®—ã«æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb16"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mpmath</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.special <span class="im">as</span> special</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> softplusJ0(x): <span class="cf">return</span> np.log(np.exp(x) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> softplusJ1(x): <span class="cf">return</span> <span class="op">-</span>special.spence(np.exp(x))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> softplusJ2(x): <span class="cf">return</span> <span class="op">-</span><span class="bu">float</span>(mpmath.polylog(<span class="dv">3</span>, <span class="op">-</span>np.exp(x))) <span class="co"># ä»»æ„ç²¾åº¦ãªã®ã§é…ã„ã€‚</span></span></code></pre></div>
  </details>
  <h3 id="swish"><a href="#swish" class="header-anchor"
  aria-hidden="true">swish</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{swish}}(x) &amp;= \frac{x}{e^{-x Î²} + 1}\\
  J^1 f_{\mathrm{swish}}(x) &amp;= \frac{x \beta \log{\left( e^{x \beta}
  + 1 \right) } + \mathrm{Li}_2 \left( -e^{x \beta} \right) }{\beta^2}\\
  J^2 f_{\mathrm{swish}}(x) &amp;= \frac{2 \mathrm{Li}_3 \left( -e^{x
  \beta}\right) -x \beta  \mathrm{Li}_2 \left( -e^{x \beta} \right)
  }{\beta^{3}}\\
  \end{aligned}
  \]</span></p>
  <p>Softplus ã¨åŒæ§˜ã« <span class="math inline">\(\mathrm{Li}\)</span>
  ãŒç¾ã‚Œã¾ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb17"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Maxima */</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="cn">x</span> / (<span class="dv">1</span> + <span class="fu">exp</span>(-Î² * <span class="cn">x</span>));</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>));</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>));</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯å‡ºåŠ›ã§ã™ã€‚</p>
  <pre><code>(J0)    x/(%e^(-(x*Î²))+1)
(J1)    (x*Î²*log(%e^(x*Î²)+1)+li[2](-%e^(x*Î²)))/Î²^2
(J2)    (2*li[3](-%e^(x*Î²))-x*Î²*li[2](-%e^(x*Î²)))/Î²^3</code></pre>
  <p>ä»¥ä¸‹ã¯æ¤œè¨¼ã®ãŸã‚ã« Wolfram Alpha
  ã§è§£ã„ãŸã¨ãã®ã‚¯ã‚¨ãƒªã§ã™ã€‚ä¸€è¡Œãšã¤ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã—ãŸã€‚ Maxima
  ã¨åŒæ§˜ã®è§£ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb19"><pre
  class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>J0 <span class="ex">=</span> <span class="fu">x</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>Î² <span class="sc">*</span> <span class="fu">x</span>));</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>J1 <span class="ex">=</span> antiderivative<span class="op">[</span><span class="fu">x</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>Î² <span class="sc">*</span> <span class="fu">x</span>))<span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>J2 <span class="ex">=</span> antiderivative<span class="op">[</span>(<span class="fu">x</span><span class="sc">*</span>Î²<span class="sc">*</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="fu">x</span><span class="sc">*</span>Î²)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span><span class="fu">polylog</span><span class="op">[</span><span class="dv">2</span><span class="op">,</span> <span class="sc">-</span><span class="fu">exp</span>(<span class="fu">x</span><span class="sc">*</span>Î²)<span class="op">]</span>)<span class="sc">/</span>Î²<span class="sc">^</span><span class="dv">2</span><span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span></code></pre></div>
  </details>
  <h3 id="exppoly"><a href="#exppoly" class="header-anchor"
  aria-hidden="true">exppoly</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{exppoly}}(x) &amp;= x^{Î²} e^{- z}\\
  J^1 f_{\mathrm{exppoly}}(x) &amp;= -\Gamma(1+\beta, z) + C_0\\
  J^2 f_{\mathrm{exppoly}}(x) &amp;= \Gamma(2+\beta, z) - z
  \Gamma(1+\beta, z) + C_0 z + C_1\\
  \\
  \text{where} \quad
  z &amp;= |x|, \quad
  C_0 = \Gamma(1 + \beta, 0), \quad
  C_1 = \Gamma(2 + \beta, 0).
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\(\Gamma(s, x)\)</span> ã¯ <a
  href="https://en.wikipedia.org/wiki/Incomplete_gamma_function">upper
  incomplete gamma function</a> ã§ã™ã€‚ <span
  class="math inline">\(C_0,\,C_1\)</span> ã¯ç©åˆ†å®šæ•°ã§ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb20"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sympy.Symbol(<span class="st">&quot;x&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Î² <span class="op">=</span> sympy.Symbol(<span class="st">&quot;Î²&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>J0 <span class="op">=</span> x<span class="op">**</span>Î² <span class="op">*</span> sympy.exp(<span class="op">-</span>sympy.Abs(x))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>J1 <span class="op">=</span> sympy.integrate(J0, x)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>J2 <span class="op">=</span> sympy.integrate(J1, x)</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯å‡ºåŠ›ã§ã™ã€‚</p>
  <pre><code>J0: integrate[x^Î² * exp(-x), x]
J1: integrate[-Gamma[1 + Î², x], x]
J2: -(x Gamma[1 + Î², x]) + Gamma[2 + Î², x]</code></pre>
  </details>
  <h3 id="sinalgexp"><a href="#sinalgexp" class="header-anchor"
  aria-hidden="true">sinalgexp</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{sinalgexp}}(x) &amp;= \sin(\pi (1 - e^{-x}))\\
  J^1 f_{\mathrm{sinalgexp}}(x) &amp;= -\operatorname{Si}(\pi e^{-x}) +
  C_0\\
  J^2 f_{\mathrm{sinalgexp}}(x) &amp;= \frac{1}{2} Ï€ e^{-x} ({}_3 F_3(1,
  1, 1;2, 2, 2;-i e^{-x} Ï€) + {}_3 F_3(1, 1, 1;2, 2, 2;i e^{-x} Ï€)) + C
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\({}_p F_q\)</span> ã¯ <a
  href="https://reference.wolfram.com/language/ref/HypergeometricPFQ.html">generalized
  hypergeometric function</a> ã§ã™ã€‚ <span class="math inline">\({}_p
  F_q\)</span> ã¯ Boost ã«å®Ÿè£…ãŒã‚ã‚Šã¾ã™ã€‚</p>
  <ul>
  <li><a
  href="https://www.boost.org/doc/libs/1_87_0/libs/math/doc/html/math_toolkit/hypergeometric/hypergeometric_pfq.html">Hypergeometric
  pFq - 1.87.0</a></li>
  </ul>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Wolfram Alpha ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb22"><pre
  class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>J0 <span class="ex">=</span> <span class="fu">sin</span>((<span class="fu">e</span><span class="sc">^</span>(<span class="fu">x</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">e</span><span class="sc">^</span>(<span class="fu">x</span>));</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>J1 <span class="ex">=</span> <span class="fu">integrate</span><span class="op">[</span><span class="fu">sin</span>((<span class="fu">e</span><span class="sc">^</span>(<span class="fu">x</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">e</span><span class="sc">^</span>(<span class="fu">x</span>))<span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>J2 <span class="ex">=</span> <span class="fu">integrate</span><span class="op">[</span><span class="sc">-</span><span class="fu">SinIntegral</span><span class="op">[</span><span class="fu">Pi</span><span class="sc">/</span><span class="fu">E</span><span class="sc">^</span><span class="fu">x</span><span class="op">],</span> <span class="fu">x</span><span class="op">]</span>;</span></code></pre></div>
  </details>
  <h3 id="sinatanexp"><a href="#sinatanexp" class="header-anchor"
  aria-hidden="true">sinatanexp</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{sinatanexp}}(x) &amp;= \sin(2 \arctan(e^x - 1))\\
  J^1 f_{\mathrm{sinatanexp}}(x) &amp;= \frac{\log((e^x - 1)^2 + 1)}{2}
  + \arctan(e^x - 1) - x\\
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\(J^2\)</span>
  ã¯è¤‡ç´ è§£ã®ã¿ã—ã‹å¾—ã‚‰ã‚Œãªã‹ã£ãŸã§ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®è§£ã‚’ä»¥ä¸‹ã®è©³ç´°æ¬„ã«æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb23"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="fu">sin</span>(<span class="dv">2</span> * <span class="fu">atan</span>(<span class="va">%e</span>^<span class="cn">x</span> - <span class="dv">1</span>));</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>);</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>); <span class="co">/* è§£ã‘ãªã„ */</span></span></code></pre></div>
  <p><code>J2</code> ãŒè§£ã‘ãªã‹ã£ãŸã®ã§ Wolfam Alpha ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb24"><pre
  class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>J0 <span class="ex">=</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> atan(<span class="fu">e</span><span class="sc">^</span><span class="fu">x</span> <span class="sc">-</span> <span class="dv">1</span>));</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>J1 <span class="ex">=</span> <span class="fu">Integrate</span><span class="op">[</span><span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> atan(<span class="fu">e</span><span class="sc">^</span><span class="fu">x</span> <span class="sc">-</span> <span class="dv">1</span>))<span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>J2 <span class="ex">=</span> <span class="fu">Integrate</span><span class="op">[</span>(<span class="sc">-</span><span class="dv">2</span> <span class="fu">x</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">I</span>) <span class="fu">ArcTan</span><span class="op">[</span><span class="dv">1</span> <span class="sc">-</span> <span class="fu">E</span><span class="sc">^</span><span class="fu">x</span><span class="op">]</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>) <span class="fu">ArcTan</span><span class="op">[</span><span class="fu">E</span><span class="sc">^</span><span class="fu">x</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">-</span> <span class="fu">E</span><span class="sc">^</span><span class="fu">x</span>)<span class="op">]</span> <span class="sc">+</span> <span class="fu">Log</span><span class="op">[</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="fu">E</span><span class="sc">^</span><span class="fu">x</span> <span class="sc">+</span> <span class="fu">E</span><span class="sc">^</span>(<span class="dv">2</span> <span class="fu">x</span>)<span class="op">]</span>)<span class="sc">/</span><span class="dv">2</span><span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span></code></pre></div>
  <p>Wolfam Alpha ã‹ã‚‰ã®å‡ºåŠ›ã§ã™ã€‚ <code>I</code> ã¯è¤‡ç´ å˜ä½ã§ã™ã€‚
  <code>J1</code> ã«ã¤ã„ã¦ã¯ Maxima
  ã®è§£ã®ã»ã†ãŒç°¡æ½”ãªå½¢ã‚’ã—ã¦ã„ã¾ã™ã€‚</p>
  <pre><code>J1 = (
  -2 * x
  - (1 - I) * ArcTan(1 - E^x)
  + (1 + I) * ArcTan(E^x/(2 - E^x))
  + Log((E^x - 1)^2 + 1)
)/2;

J2 = (
  -x^2
  + Log(E^x) * Log((E^x - 1)^2 + 1)
  - (1 - I) * x * ArcTan(1 - E^x)
  + (1 + I) * x * ArcTan(E^x/(2 - E^x))
  - (Log(E^x) - I) * x * Log(1 - (1/2 - I/2) * E^x)
  - (Log(E^x) + I) * x * Log(1 - (1/2 + I/2) * E^x)
  - (1 - I) * PolyLog(2, (1/2 - I/2) * E^x)
  - (1 + I) * PolyLog(2, (1/2 + I/2) * E^x)
)/2</code></pre>
  </details>
  <h3 id="cosdecay"><a href="#cosdecay" class="header-anchor"
  aria-hidden="true">cosdecay</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{cosdecay}}(x) &amp;= \frac{1 - \cos(x)}{x}\\
  J^1 f_{\mathrm{cosdecay}}(x) &amp;= \log(x) - \operatorname{Ci}(x)\\
  J^2 f_{\mathrm{cosdecay}}(x) &amp;= \sin(x) + x (\log(x) -
  \operatorname{Ci}(x) - 1)\\
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>SymPy ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb26"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sympy.Symbol(<span class="st">&quot;x&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>J0 <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> sympy.cos(x)) <span class="op">/</span> x</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>J1 <span class="op">=</span> sympy.integrate(J0, x)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>J2 <span class="op">=</span> sympy.integrate(J1, x)</span></code></pre></div>
  </details>
  <h3 id="log1p"><a href="#log1p" class="header-anchor"
  aria-hidden="true">log1p</a></h3>
  <p><span class="math display">\[
  \begin{aligned}
  J^0 f_{\mathrm{log1p}}(x) &amp;= \mathrm{sgn}(z) \log (z + 1) \\
  J^1 f_{\mathrm{log1p}}(x) &amp;= (z + 1) \log(z + 1) - z \\
  J^2 f_{\mathrm{log1p}}(x) &amp;= \frac{\mathrm{sgn}(z)}{4} \left( 2 (z
  + 1)^2 \log(z + 1) - 3 z^2 - 2 z \right) \\\\
  \text{where} \quad z &amp;= |x|.
  \end{aligned}
  \]</span></p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Maxima ã§è§£ãã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb27"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="cn">J0</span>: <span class="fu">log</span>(<span class="dv">1</span>+<span class="cn">x</span>);</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cn">J1</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J0</span>, <span class="cn">x</span>));</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cn">J2</span>: <span class="fu">ratsimp</span>(<span class="fu">integrate</span>(<span class="cn">J1</span>, <span class="cn">x</span>));</span></code></pre></div>
  <p>å‡ºåŠ›ã§ã™ã€‚</p>
  <pre><code>(J0)    log(x+1)
(J1)    (x+1)*log(x+1)-x-1
(J2)    ((2*x^2+4*x+2)*log(x+1)-3*x^2-6*x)/4</code></pre>
  <p><code>J1</code> ã®ç©åˆ†å®šæ•°ã‚’ 1 ã¨ã™ã‚‹ã¨
  <code>(x+1)*log(x+1)-x</code>
  ã¨ãªã‚Šã¾ã™ã€‚ã“ã®å¼ã‚’é€†å¾®åˆ†ã™ã‚‹ã¨ä¸Šã§æ²è¼‰ã—ã¦ã„ã‚‹å¼ãŒå‡ºã¾ã™ã€‚ç©åˆ†å®šæ•°ã‚’å¤‰ãˆãŸã®ã¯ã€
  Maxima ã®è§£ã®å½¢ã ã¨ <code>J1</code> ãŒ 0
  ã®å‘¨ã‚Šã§ä¸é€£ç¶šã«ãªã£ã¦ã„ãŸã‹ã‚‰ã§ã™ã€‚</p>
  </details>
  <h3 id="sinrunge"><a href="#sinrunge" class="header-anchor"
  aria-hidden="true">sinrunge</a></h3>
  <p><a href="https://en.wikipedia.org/wiki/Runge%27s_phenomenon">Runge
  é–¢æ•°</a>ã« sin ã‚’ä¹—ç®—ã—ãŸå¼ã§ã™ã€‚</p>
  <p><span class="math display">\[
  J^0 f_{\mathrm{sinrunge}}(x) = \frac{\sin(x)}{25 x^2 + 1}.
  \]</span></p>
  <p>é€†å¾®åˆ†ã«ã¤ã„ã¦ã¯è¤‡ç´ è§£ã—ã‹å¾—ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã€ä»¥ä¸‹ã®è©³ç´°æ¬„ã«ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§ã®ã¿æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Wolfram Alpha ã‚’ä½¿ã„ã¾ã™ã€‚ Maxima 5.47.0 ã¨ SymPy 1.13.3
  ã§ã¯è§£ã‘ãªã‹ã£ãŸã§ã™ã€‚</p>
  <div class="sourceCode" id="cb29"><pre
  class="sourceCode mathematica"><code class="sourceCode mathematica"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>J1 <span class="ex">=</span> <span class="fu">integrate</span><span class="op">[</span><span class="fu">sin</span>(<span class="fu">x</span>)<span class="sc">/</span>(<span class="dv">25</span><span class="sc">*</span><span class="fu">x</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>J2 <span class="ex">=</span> <span class="fu">integrate</span><span class="op">[</span>(<span class="fu">CosIntegral</span><span class="op">[</span><span class="fu">I</span><span class="sc">/</span><span class="dv">5</span> <span class="sc">-</span> <span class="fu">x</span><span class="op">]</span> <span class="fu">Sinh</span><span class="op">[</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span><span class="op">]</span> <span class="sc">+</span> <span class="fu">CosIntegral</span><span class="op">[</span><span class="fu">I</span><span class="sc">/</span><span class="dv">5</span> <span class="sc">+</span> <span class="fu">x</span><span class="op">]</span> <span class="fu">Sinh</span><span class="op">[</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span><span class="op">]</span> <span class="sc">+</span> <span class="fu">I</span> <span class="fu">Cosh</span><span class="op">[</span><span class="dv">1</span><span class="sc">/</span><span class="dv">5</span><span class="op">]</span> (<span class="fu">SinIntegral</span><span class="op">[</span><span class="fu">I</span><span class="sc">/</span><span class="dv">5</span> <span class="sc">-</span> <span class="fu">x</span><span class="op">]</span> <span class="sc">+</span> <span class="fu">SinIntegral</span><span class="op">[</span><span class="fu">I</span><span class="sc">/</span><span class="dv">5</span> <span class="sc">+</span> <span class="fu">x</span><span class="op">]</span>))<span class="sc">/</span><span class="dv">10</span><span class="op">,</span> <span class="fu">x</span><span class="op">]</span>;</span></code></pre></div>
  <p>è¤‡ç´ è§£ã§ã™ã€‚å®Ÿéƒ¨ã‚’å–ã‚Šå‡ºã›ã° ADAA ã«åˆ©ç”¨ã§ãã¾ã™ã€‚</p>
  <pre><code>J1 = (
  +     sinh(1/5) * (Ci(I/5 - x) + Ci(I/5 + x))
  + I * cosh(1/5) * (Si(I/5 - x) + Si(I/5 + x))
) / 10;

J2 = (
  + (-1 + exp(2/5)) * ((-I + 5   * x) * Ci(I/5 - x) + (+I + 5   * x) * Ci(I/5 + x))
  + (+1 + exp(2/5)) * ((+1 + 5*I * x) * Si(I/5 - x) + (-1 + 5*I * x) * Si(I/5 + x))
)/(100 * exp(1/5));</code></pre>
  </details>
  <h3 id="è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†"><a href="#è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†"
  class="header-anchor" aria-hidden="true">è§£ã‘ãªã‹ã£ãŸé€†å¾®åˆ†</a></h3>
  <p>ä»¥ä¸‹ã¯ exppoly ã¨ä¼¼ãŸã‚ˆã†ãªå½¢ã®é–¢æ•°ã§ã™ã€‚ Upper incomplete gamma
  function ã®ç§»æ¤ã‚’é¿ã‘ãŸã‹ã£ãŸã®ã§èª¿ã¹ã¾ã—ãŸã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  &amp; \int \sin(\pi \tanh(e^x - 1)) dx\\
  &amp; \int \sin(\pi \operatorname{erf}(x)) dx\\
  &amp; \int \sin \left(\pi \left( \frac{2}{(e^x + 1)} - 1 \right)
  \right) dx\\
  &amp; \int \arctan(\sin(\pi e^{-x})) dx\\
  &amp; \int \frac{\sin(\pi e^{-x})}{\sin(\pi e^{-x}) + 1} dx\\
  \end{aligned}
  \]</span></p>
  <h3 id="æ¬¡ä»¥ä¸Šã®-adaa"><a href="#æ¬¡ä»¥ä¸Šã®-adaa" class="header-anchor"
  aria-hidden="true">3 æ¬¡ä»¥ä¸Šã® ADAA</a></h3>
  <p>3 æ¬¡ä»¥ä¸Šã® ADAA ã«ã¤ã„ã¦ã‚‚èª¿ã¹ãŸã®ã§ã™ãŒã€ ill-condition
  ã®æ‰±ã„ãŒæ‰‹é–“ã ã£ãŸã®ã§é€”ä¸­ã§è«¦ã‚ã¾ã—ãŸã€‚ä»»æ„ã®æ¬¡æ•°ã® ADAA
  ã®å¼ã ã‘ã§ã‚ã‚Œã°ä»¥ä¸‹ã«ãƒªãƒ³ã‚¯ã—ãŸã‚³ãƒ¼ãƒ‰ã§è¨ˆç®—ã§ãã¾ã™ã€‚</p>
  <ul>
  <li><a
  href="https://github.com/ryukau/filter_notes/blob/master/antiderivative_antialiasing/solve_bilbao.py">filter_notes/antiderivative_antialiasing/solve_bilbao.py
  at master Â· ryukau/filter_notes Â· GitHub</a></li>
  </ul>
  <p>ä»¥ä¸‹ã®è©³ç´°ã®æ¬„ã®å†…å®¹ã¯æœªæ¤œè¨¼ã§ã™ã€‚</p>
  <details>
  <summary>
  è©³ç´°
  </summary>
  <p>Bilbao ã‚‰ã®æ‰‹æ³•ã¯ Parker ã‚‰ã®æ‰‹æ³•ã¨ 1
  æ¬¡ã®ã¨ãã¯åŒã˜ã€‚é›¢æ•£ç³»ã®è¨ˆç®—å¼ã‚’æœ‰é™å·®åˆ†ã®å¼ã‹ã‚‰æ±‚ã‚ã¦ã„ã‚‹ç‚¹ãŒ Parker
  ã‚‰ã®æ‰‹æ³•ã¨ã¯ç•°ãªã‚‹ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  y^{(1)}_n &amp;= \frac{{F}^{(1)}_{n} - {F}^{(1)}_{n - 1} }{{x}_{n} -
  {x}_{n - 1}}
  \\
  y^{(2)}_n &amp;=
  \frac{2}{{x}_{n} - {x}_{n - 2}} \left(
      \frac{{F}^{(2)}_{n} - {F}^{(2)}_{n - 1} }{{x}_{n} - {x}_{n - 1}}
    - \frac{{F}^{(2)}_{n - 1} - {F}^{(2)}_{n - 2}}{{x}_{n - 1} - {x}_{n
  - 2}}
  \right)
  \\
  y^{(3)}_n &amp;=
  \frac{2}{{x}_{n - 1} - {x}_{n - 2}} \left(
    \frac{1}{{x}_{n} - {x}_{n - 2}} \left(
      \frac{{F}^{(3)}_{n} - {F}^{(3)}_{n - 1} }{{x}_{n} - {x}_{n - 1}}
    - \frac{{F}^{(3)}_{n - 1} - {F}^{(3)}_{n - 2}}{{x}_{n - 1} - {x}_{n
  - 2}}
    \right)
  - \frac{1}{{x}_{n - 1} - {x}_{n - 3}} \left(
      \frac{{F}_{n - 1} - {F}_{n - 2}}{{x}_{n - 1} - {x}_{n - 2}}
    - \frac{{F}_{n - 2} - {F}_{n - 3}}{{x}_{n - 2} - {x}_{n - 3}}
    \right)
  \right)
  \\
  y^{(4)}_n &amp;=
  \frac{4}{{x}_{n - 1} - {x}_{n - 3}} \left(
    \frac{1}{{x}_{n - 1} - {x}_{n - 2}} \left(
      \frac{1}{{x}_{n} - {x}_{n - 2}} \left(
        \frac{{F}^{(4)}_{n} - {F}^{(4)}_{n - 1} }{{x}_{n} - {x}_{n - 1}}
      - \frac{{F}^{(4)}_{n - 1} - {F}^{(4)}_{n - 2}}{{x}_{n - 1} -
  {x}_{n - 2}}
      \right)
    - \frac{1}{{x}_{n - 1} - {x}_{n - 3}} \left(
        \frac{{F}^{(4)}_{n - 1} - {F}^{(4)}_{n - 2}}{{x}_{n - 1} -
  {x}_{n - 2}}
      - \frac{{F}^{(4)}_{n - 2} - {F}^{(4)}_{n - 3}}{{x}_{n - 2} -
  {x}_{n - 3}}
      \right)
    \right)
  - \frac{1}{{x}_{n - 2} - {x}_{n - 3}} \left(
      \frac{1}{{x}_{n - 1} - {x}_{n - 3}} \left(
        \frac{{F}^{(4)}_{n - 1} - {F}^{(4)}_{n - 2}}{{x}_{n - 1} -
  {x}_{n - 2}}
      - \frac{{F}^{(4)}_{n - 2} - {F}^{(4)}_{n - 3}}{{x}_{n - 2} -
  {x}_{n - 3}}
      \right)
    - \frac{1}{{x}_{n - 2} - {x}_{n - 4}} \left(
        \frac{{F}^{(4)}_{n - 2} - {F}^{(4)}_{n - 3}}{{x}_{n - 2} -
  {x}_{n - 3}}
      - \frac{{F}^{(4)}_{n - 3} - {F}^{(4)}_{n - 4}}{{x}_{n - 3} -
  {x}_{n - 4}}
      \right)
    \right)
  \right)
  \end{aligned}
  \]</span></p>
  <p>è¨˜å·ã‚’å®šç¾©ã—ã¦æ•´ç†ã€‚</p>
  <p><span class="math display">\[
  q^{(i)}_a = \frac{{F}^{(i)}_{n - a} - {F}^{(i)}_{n - a - 1}}{{x}_{n -
  a} - {x}_{n - a - 1}}
  ,\quad
  r_{a,b} = {x}_{n - a} - {x}_{n - b}.
  \]</span></p>
  <p><span class="math display">\[
  \begin{aligned}
  y^{(1)}_n &amp;= q^{(1)}_0
  \\
  y^{(2)}_n &amp;= \frac{2}{r_{0,2}} \left( q^{(2)}_0 - q^{(2)}_1
  \right)
  \\
  y^{(3)}_n &amp;=
  \frac{2}{r_{1,2}} \left(
    \frac{1}{r_{0,2}} \left( q^{(3)}_0 - q^{(3)}_1 \right)
  - \frac{1}{r_{1,3}} \left( q^{(3)}_1 - q^{(3)}_2 \right)
  \right)
  \\
  y^{(4)}_n &amp;=
  \frac{4}{r_{1,3}} \left(
    \frac{1}{r_{1,2}} \left(
      \frac{1}{r_{0,2}} \left( q^{(4)}_0 - q^{(4)}_1 \right)
    - \frac{1}{r_{1,3}} \left( q^{(4)}_1 - q^{(4)}_2 \right)
    \right)
  - \frac{1}{r_{2,3}} \left(
      \frac{1}{r_{1,3}} \left( q^{(4)}_1 - q^{(4)}_2 \right)
    - \frac{1}{r_{2,4}} \left( q^{(4)}_2 - q^{(4)}_3 \right)
    \right)
  \right)
  \end{aligned}
  \]</span></p>
  <p>0
  é™¤ç®—ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ç„¡è¦–ã™ã‚‹ãªã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ã«åŠ¹ç‡ã‚ˆãè¨ˆç®—ã§ãã‚‹ã€‚ 1
  ã‚µãƒ³ãƒ—ãƒ«ã®è¨ˆç®—ã§ã¯ã€æ¬¡æ•°ã«ã‚ˆã‚‰ãš <code>s1</code> ã«ã¤ã„ã¦ã®ã¿ <span
  class="math inline">\(F\)</span> ã®è¨ˆç®—ã‚’è¡Œãˆã°ã„ã„ã€‚</p>
  <pre><code>s1 = (F4(x[n]) - F4(x[n - 1])) / r(0, 1);
s2 = (s1 - y1) / r(0, 2);
s3 = (s2 - y2) / r(1, 2);
s4 = (s3 - y3) / r(1, 3);
output = 4 * s4;
y1 = s1
y2 = s2
y3 = s3</code></pre>
  <p><code>s</code> ã®åˆ†æ¯ã® <code>r</code> ã¯ä»¥ä¸‹ã®è¦å‰‡ã§å¢—ãˆã‚‹ã€‚</p>
  <ul>
  <li><code>s</code> ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¥‡æ•°ã‹ã‚‰å¶æ•°ã«ãªã‚‹ã¨ãã€å¾Œã®å¼•æ•°ã«
  +1 ã€‚</li>
  <li><code>s</code> ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¶æ•°ã‹ã‚‰å¥‡æ•°ã«ãªã‚‹ã¨ãã€å‰ã®å¼•æ•°ã«
  +1 ã€‚</li>
  </ul>
  <p>ã¤ã¾ã‚Š
  <code>[r(0, 1), r(0, 2), r(1, 2), r(1, 3), r(2, 3), r(2, 4), r(3, 4), r(3, 5), ...]</code>
  ã€‚</p>
  <p>0 é™¤ç®—ã‚’è€ƒæ…®ã™ã‚‹ã¨åŠ¹ç‡ã®ã„ã„è¨ˆç®—æ–¹æ³•ã¯ä½¿ãˆãªã„ã€‚ <code>F</code>
  ã®è¨ˆç®—å›æ•°ã¯æ¬¡æ•°ã«å¿œã˜ã¦ 2
  ã®ã¹ãä¹—ã®ã‚ªãƒ¼ãƒ€ãƒ¼ã§å¢—ãˆã¦ã„ãã®ã§ã€å®Ÿç”¨ä¸Šã¯ 2
  æ¬¡ã¾ã§ã¨è€ƒãˆã¦ã„ã„ã€‚</p>
  <p>ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®è¨ˆç®—ã‚’æ‰‹æŠœãã™ã‚‹ãªã‚‰ä»¥ä¸‹ã®å¼ãŒä½¿ãˆã‚‹ã€‚<a
  href="https://en.wikipedia.org/wiki/Pascal&#39;s_triangle">ãƒ‘ã‚¹ã‚«ãƒ«ã®ä¸‰è§’å½¢</a>ã«åŸºã¥ãã€‚</p>
  <p><span class="math display">\[
  \tilde{y}^{(d)}_n = F^{(0)} \left(
    \frac{1}{2^d}
    \sum_{i=1}^d \left[ (-1)^{i+1} \binom{k}{i} x_{n-i} \right]
  \right).
  \]</span></p>
  </details>
  <h2 id="é€£ç¶šé ˜åŸŸã§-fir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰"><a
  href="#é€£ç¶šé ˜åŸŸã§-fir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰"
  class="header-anchor" aria-hidden="true">é€£ç¶šé ˜åŸŸã§ FIR
  ãƒ•ã‚£ãƒ«ã‚¿ã‚’ç•³ã¿è¾¼ã‚€æ‰‹æ³•ã®æ”¹å¤‰</a></h2>
  <p><a
  href="https://dafx16.vutbr.cz/dafxpapers/20-DAFx-16_paper_41-PN.pdf">Parker
  ã‚‰ã®æ‰‹æ³•</a>ã«ã¤ã„ã¦ã€é€£ç¶šé ˜åŸŸã§ç•³ã¿è¾¼ã‚€ FIR
  ãƒ•ã‚£ãƒ«ã‚¿ã‚’ä¸‰è§’çª“ã‹ã‚‰ã‚³ã‚µã‚¤ãƒ³çª“ã«å¤‰ãˆã‚‹ã¨ã©ã†ãªã‚‹ã‹è©¦ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã¯ã‚³ã‚µã‚¤ãƒ³çª“ã®å®šç¾©ã§ã™ã€‚</p>
  <p><span class="math display">\[
  h_{\mathrm{cos}}(t) = \begin{cases}
  \dfrac{1 - \cos(\pi t)}{2}, &amp; 0 \leq t &lt; 2 \\
  0, &amp; \text{otherwise}
  \end{cases}
  \]</span></p>
  <p>Parker ã‚‰ã®å¼ 12 ã¨åŒæ§˜ã«å±•é–‹ã—ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  \tilde{y}(n)
  &amp;=
  \int_{-\infty}^{\infty} h_{\mathrm{cos}}(u) y(n - u) du
  \\&amp;=
  \int_0^2 \frac{1 - \cos(\pi u)}{2} y(n - u) du
  \\&amp;=
    \int_0^1 \frac{1 - \cos(\pi \tau)}{2} f(x_n + \tau(x_{n-1} - x_n)) d
  \tau
  + \int_0^1 \frac{1 - \cos(\pi (\tau + 1))}{2} f(x_{n-1} + \tau(x_{n-2}
  - x_{n-1})) d \tau
  \\&amp;=
    \int_0^1 \frac{1 - \cos(\pi \tau)}{2} f(x_n + \tau(x_{n-1} - x_n)) d
  \tau
  + \int_0^1 \frac{1 + \cos(\pi \tau)}{2} f(x_{n-1} + \tau(x_{n-2} -
  x_{n-1})) d \tau
  \end{aligned}
  \]</span></p>
  <p>ã“ã“ã§ integration by substitution ãŒä½¿ãˆãªã„ã®ã§ã€ Parker ã‚‰ã®å¼
  13 ã¯ä½¿ãˆã¾ã›ã‚“ã€‚ <span class="math inline">\(f\)</span>
  ã‚’ç›´æ¥ä»£å…¥ã—ã¦è§£ãã¾ã™ã€‚</p>
  <h3 id="ill-condition"><a href="#ill-condition" class="header-anchor"
  aria-hidden="true">Ill-condition</a></h3>
  <p>Ill-condition ã«å¯¾å¿œã™ã‚‹ãŸã‚ Parker ã‚‰ã®å¼ 39 ã¨å¼ 41 ã‚’ä½¿ã„ã¾ã™ã€‚
  <span class="math inline">\(M_1\)</span> ã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®éš›ã« <span
  class="math inline">\(\tau\)</span> ã«ä»£å…¥ã™ã‚‹å€¤ã§ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  \int_0^1 y(\tau)\bar{h}(\tau) d\tau &amp;= (x_n + M_1 (x_{n-1} - x_n))
  \int_0^1 \bar{h}(\tau) d\tau \\
  M_1 &amp;= \frac{\int_0^1 \tau \bar{h}(\tau) d\tau}{\int_0^1
  \bar{h}(\tau) d\tau}.
  \end{aligned}
  \]</span></p>
  <p><span class="math inline">\(\bar{h}\)</span> ã« <span
  class="math inline">\(h_{\mathrm{cos}}\)</span> ã‚’ä»£å…¥ã—ã¦è§£ãã¾ã™ã€‚
  <span class="math inline">\(f\)</span>
  ã¯åŠæ³¢æ•´æµãªã©ã®éç·šå½¢é–¢æ•°ã§ã™ã€‚ç•³ã¿è¾¼ã¿ã®å‰åŠã¨å¾ŒåŠã§ 2
  ã¤ã®å¼ãŒç¾ã‚Œã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  \int_0^1 h_{\mathrm{cos}}(\tau) d\tau
  &amp;= \int_0^1 \frac{1 \mp \cos(\pi \tau)}{2} d\tau
  = \frac{1}{2},
  \\
  M_1
  &amp;=\frac{\int_0^1 \tau h_{\mathrm{cos}}(\tau) d\tau}{\int_0^1
  h_{\mathrm{cos}}(\tau) d\tau}
  = \frac{
    \displaystyle \int_0^1 \tau \frac{1 \mp \cos(\pi \tau)}{2} d\tau
  }{
    1/2
  }
  = \frac{1}{2} \pm \frac{2}{\pi^{2}},
  \\
  \int_0^1 y(\tau)\bar{h}(\tau) d\tau
  &amp;= \begin{cases}
    \displaystyle
    \frac{1}{2} f \left( x_n + \left( \frac{1}{2} + \frac{2}{\pi^{2}}
  \right) (x_{n-1} - x_n) \right)
    \\
    \displaystyle
    \frac{1}{2} f \left( x_{n-1} + \left( \frac{1}{2} -
  \frac{2}{\pi^{2}} \right) (x_{n-2} - x_{n-1}) \right)
  \end{cases}
  \end{aligned}
  \]</span></p>
  <div class="sourceCode" id="cb32"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tau <span class="op">=</span> sympy.symbols(<span class="st">&quot;Ï„&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> M1(h):</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    numer <span class="op">=</span> sympy.integrate(tau <span class="op">*</span> h, (tau, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    denom <span class="op">=</span> sympy.integrate(h, (tau, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(sympy.latex(numer <span class="op">/</span> denom))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(sympy.latex(denom))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>M1((<span class="dv">1</span> <span class="op">-</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>M1((<span class="dv">1</span> <span class="op">+</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span>)</span></code></pre></div>
  <h3 id="tanh-1"><a href="#tanh-1" class="header-anchor"
  aria-hidden="true">tanh</a></h3>
  <p>ä»¥ä¸‹ã®å¼ã‚’è§£ãå¿…è¦ãŒã‚ã‚‹ã®ã§ã™ãŒã€ Maxima, SymPy, Wolfram Alpha
  ã§ã¯è§£ã‘ãªã‹ã£ãŸã§ã™ã€‚</p>
  <p><span class="math display">\[
  \int_0^1 \frac{1 - \cos(\pi \tau)}{2} \tanh(x_n + \tau(x_{n-1} - x_n))
  d \tau
  \]</span></p>
  <div class="sourceCode" id="cb33"><pre
  class="sourceCode maxima"><code class="sourceCode maxima"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cn">expr</span>: (<span class="dv">1</span> - <span class="fu">cos</span>(<span class="va">%pi</span> * <span class="cn">tau</span>)) / <span class="dv">2</span> * <span class="fu">tanh</span>(<span class="cn">x0</span> + <span class="cn">tau</span> * (<span class="cn">x1</span> - <span class="cn">x0</span>));</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cn">expr</span>, <span class="cn">tau</span>, <span class="dv">0</span>, <span class="dv">1</span>);</span></code></pre></div>
  <div class="sourceCode" id="cb34"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tau, x0, x1 <span class="op">=</span> sympy.symbols(<span class="st">&quot;Ï„, x_0 x_1&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>expr <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> sympy.tanh(x0 <span class="op">+</span> tau <span class="op">*</span> (x1 <span class="op">-</span> x0))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> sympy.integrate(expr, (tau, <span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
  <h3 id="åŠæ³¢æ•´æµ"><a href="#åŠæ³¢æ•´æµ" class="header-anchor"
  aria-hidden="true">åŠæ³¢æ•´æµ</a></h3>
  <p>ç•³ã¿è¾¼ã¿ã®å‰åŠã ã‘ã‚’æ‰±ã„ã¾ã™ã€‚å¾ŒåŠã¯ <span
  class="math inline">\(x_{n+1} \to x_{n+2}\)</span> ã€ <span
  class="math inline">\(x_n \to x_{n+1}\)</span> ã¨ç½®ãæ›ã‚ã‚Šã€ <span
  class="math inline">\(h_{\mathrm{cos}}\)</span> ã®å±•é–‹ãŒ <span
  class="math inline">\(\dfrac{1 - \cos(\pi \tau)}{2}\)</span> ã‹ã‚‰
  <span class="math inline">\(\dfrac{1 + \cos(\pi \tau)}{2}\)</span>
  ã¸ã¨å¤‰ã‚ã‚Šã¾ã™ã€‚</p>
  <p>ä»¥ä¸‹ã¯åŠæ³¢æ•´æµã®å®šç¾©ã§ã™ã€‚</p>
  <p><span class="math display">\[
  f_{\mathrm{HalfRect}}(x) = \begin{cases}
    0, &amp; x &lt; 0 \\
    x, &amp; 0 \leq x
  \end{cases}
  \]</span></p>
  <p>å…¥åŠ›ä¿¡å· <span class="math inline">\(x\)</span> ã®å€¤ã«å¿œã˜ã¦ 4
  ã¤ã®åˆ†å²ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šã‹ã‚‰é †ã«ã‚±ãƒ¼ã‚¹ 0 ã‹ã‚‰ 3
  ã¨ç•ªå·ã‚’æŒ¯ã£ã¦ãŠãã¾ã™ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  \int_0^1 h_{\mathrm{cos}}(\tau) f_{\mathrm{HalfRect}}(x_n +
  \tau(x_{n-1} - x_n)) d \tau
  &amp;= \begin{cases}
  0
  , &amp; x_n &lt; 0,    \ x_{n-1} &lt; 0  &amp;&amp; \text{(Case
  0)}  \\
  \displaystyle \int_p^1 h_{\mathrm{cos}}(\tau) (x_n + \tau(x_{n-1} -
  x_n)) d \tau
  , &amp; x_n &lt; 0,    \ x_{n-1} \geq 0 &amp;&amp; \text{(Case 1)} \\
  \displaystyle \int_0^p h_{\mathrm{cos}}(\tau) (x_n + \tau(x_{n-1} -
  x_n)) d \tau
  , &amp; x_n \geq 0, \ x_{n-1} &lt; 0 &amp;&amp; \text{(Case 2)} \\
  \displaystyle \int_0^1 h_{\mathrm{cos}}(\tau) (x_n + \tau(x_{n-1} -
  x_n)) d \tau
  , &amp; x_n \geq 0, \ x_{n-1} \geq 0 &amp;&amp; \text{(Case 3)} \\
  \end{cases}
  \\
  \text{where}
  \quad p &amp;= \frac{-x_n}{x_{n-1} - x_n}.
  \end{aligned}
  \]</span></p>
  <p>ä»¥ä¸‹ã¯è§£ã‚’è¨ˆç®—ã™ã‚‹ SymPy ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚æ‰‹æ¢ã‚Šã§è¡Œã£ãŸãŸã‚ Term 1 ã¨
  Term 2
  ã®ã‚³ãƒ¼ãƒ‰ãŒå¤§å¹…ã«é‡è¤‡ã—ã¦ã„ã¾ã™ãŒã€æ•´ç†ã—ã¦ã‚‚å†åˆ©ç”¨ã™ã‚‹ç”¨é€”ãŒãªã„ã®ã§ãã®ã¾ã¾æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb35"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solveCosine_HalfRect():</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    tau, x0, x1, x2 <span class="op">=</span> sympy.symbols(<span class="st">&quot;Ï„, x_0, x_1, x_2&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;--- Term 1&quot;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    expr <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> (x0 <span class="op">+</span> tau <span class="op">*</span> (x1 <span class="op">-</span> x0))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="op">-</span>x0 <span class="op">/</span> (x1 <span class="op">-</span> x0)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    cases <span class="op">=</span> [</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, p, <span class="dv">1</span>]),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, <span class="dv">0</span>, p]),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, <span class="dv">0</span>, <span class="dv">1</span>]),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, expr <span class="kw">in</span> <span class="bu">enumerate</span>(cases):</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.simplify(expr)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;-- Case </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(expr, end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;--- Term 2&quot;</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    expr <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> (x1 <span class="op">+</span> tau <span class="op">*</span> (x2 <span class="op">-</span> x1))</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="op">-</span>x1 <span class="op">/</span> (x2 <span class="op">-</span> x1)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    cases <span class="op">=</span> [</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, p, <span class="dv">1</span>]),</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, <span class="dv">0</span>, p]),</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        sympy.integrate(expr, [tau, <span class="dv">0</span>, <span class="dv">1</span>]),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, expr <span class="kw">in</span> <span class="bu">enumerate</span>(cases):</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.simplify(expr)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;-- Case </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(expr, end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯ ADAA ã®å®Ÿè£…ã¸ã®ãƒªãƒ³ã‚¯ã§ã™ã€‚å‹•ä½œç¢ºèªã®ãŸã‚ã« SymPy
  ã‹ã‚‰ã®å‡ºåŠ›ã‚’ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼ã—ãŸã ã‘ãªã®ã§è¨ˆç®—åŠ¹ç‡ãŒæ‚ªã„ã§ã™ã€‚æ‰‹ã§ã®å¼ã®æ•´ç†ã¯ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªã„ã¨åˆ¤æ–­ã—ã¦ä¸­æ–­ã—ã¾ã—ãŸã€‚</p>
  <ul>
  <li>https://github.com/ryukau/filter_notes/blob/e4608cfa031213dcf794204dcc5ada389946bbc3/antiderivative_antialiasing/adaa_parkermod.py#L106-L192</li>
  </ul>
  <h3 id="ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—"><a href="#ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—"
  class="header-anchor" aria-hidden="true">ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—</a></h3>
  <p>ä»¥ä¸‹ã¯ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—ã®å®šç¾©ã§ã™ã€‚<span class="math inline">\(|x|
  \leq 1\)</span> ã¯ã€ <span class="math inline">\(-1 \leq x \leq
  1\)</span>
  ã¨ç­‰ä¾¡ã§ã™ã€‚ä»¥é™ã®è¡¨è¨˜ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ãŸã‚ã«çµ¶å¯¾å€¤ã«ã‚ˆã‚‹è¡¨è¨˜ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</p>
  <p><span class="math display">\[
  f_{\mathrm{HardClip}}(x) = \begin{cases}
    -1, &amp;  x &lt; -1 \\
     x, &amp; |x| \leq 1 \\
     1, &amp;  1 &lt; x \\
  \end{cases}
  \]</span></p>
  <p>9 ã¤ã®åˆ†å²ãŒã‚ã‚Šã¾ã™ã€‚ä¸Šã‹ã‚‰é †ã«ã‚±ãƒ¼ã‚¹ 0 ã‹ã‚‰ 8
  ã¾ã§ç•ªå·ã‚’æŒ¯ã£ã¦ãŠãã¾ã™ã€‚ <span
  class="math inline">\((-1),\,(+1),\,(L)\)</span>
  ã®è¡¨è¨˜ã¯å¾Œã§ç¢ºèªã—ã‚„ã™ã„ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã ã‘ã§ã€é–¢æ•°ã®å¼•æ•°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  <p><span class="math display">\[
  \begin{aligned}
  \int_0^1 h_{\mathrm{cos}}(\tau) f_{\mathrm{HardClip}}(x_n +
  \tau(x_{n-1} - x_n)) d \tau
  &amp;= \begin{cases}
  -1/2
  , &amp; x_n &lt; -1,     \ x_{n-1} &lt; -1     &amp;&amp; \text{(Case
  0)} \\
  \displaystyle \int_0^a h_{\mathrm{cos}}(\tau) (-1) d \tau
  + \displaystyle \int_a^1 h_{\mathrm{cos}}(\tau) (L) d \tau
  , &amp; x_n &lt; -1,     \ |x_{n-1}| \leq 1 &amp;&amp; \text{(Case 1)}
  \\
  \displaystyle \int_0^a h_{\mathrm{cos}}(\tau) (-1) d \tau
  + \displaystyle \int_a^b h_{\mathrm{cos}}(\tau) (L) d \tau
  + \displaystyle \int_b^1 h_{\mathrm{cos}}(\tau) (+1) d \tau
  , &amp; x_n &lt; -1,     \ x_{n-1} &gt; 1      &amp;&amp; \text{(Case
  2)} \\
  \displaystyle \int_0^a h_{\mathrm{cos}}(\tau) (L) d \tau
  + \displaystyle \int_a^1 h_{\mathrm{cos}}(\tau) (-1) d \tau
  , &amp; |x_n| \leq 1, \ x_{n-1} &lt; -1     &amp;&amp; \text{(Case 3)}
  \\
  \displaystyle \int_0^1 h_{\mathrm{cos}}(\tau) (L) d \tau
  , &amp; |x_n| \leq 1, \ |x_{n-1}| \leq 1 &amp;&amp; \text{(Case 4)} \\
  \displaystyle \int_0^b h_{\mathrm{cos}}(\tau) (L) d \tau
  + \displaystyle \int_b^1 h_{\mathrm{cos}}(\tau) (+1) d \tau
  , &amp; |x_n| \leq 1, \ x_{n-1} &gt; 1      &amp;&amp; \text{(Case 5)}
  \\
  \displaystyle \int_0^b h_{\mathrm{cos}}(\tau) (+1) d \tau
  + \displaystyle \int_b^a h_{\mathrm{cos}}(\tau) (L) d \tau
  + \displaystyle \int_a^1 h_{\mathrm{cos}}(\tau) (-1) d \tau
  , &amp; x_n &gt; 1,      \ x_{n-1} &lt; -1     &amp;&amp; \text{(Case
  6)} \\
  \displaystyle \int_0^b h_{\mathrm{cos}}(\tau) (+1) d \tau
  + \displaystyle \int_b^1 h_{\mathrm{cos}}(\tau) (L) d \tau
  , &amp; x_n &gt; 1,      \ |x_{n-1}| \leq 1 &amp;&amp; \text{(Case 7)}
  \\
  1/2
  , &amp; x_n &gt; 1,      \ x_{n-1} &gt; 1      &amp;&amp; \text{(Case
  8)} \\
  \end{cases}
  \\
  \text{where} \quad
  L &amp;= x_n + \tau(x_{n-1} - x_n), \quad
  a = \frac{-x_n - 1}{x_{n-1} - x_n}, \quad
  b = \frac{-x_n + 1}{x_{n-1} - x_n}.
  \end{aligned}
  \]</span></p>
  <p>ä»¥ä¸‹ã¯è§£ã‚’è¨ˆç®—ã™ã‚‹ SymPy ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚æ‰‹æ¢ã‚Šã§è¡Œã£ãŸãŸã‚ Term 1 ã¨
  Term 2
  ã®ã‚³ãƒ¼ãƒ‰ãŒå¤§å¹…ã«é‡è¤‡ã—ã¦ã„ã¾ã™ãŒã€æ•´ç†ã—ã¦ã‚‚å†åˆ©ç”¨ã™ã‚‹ç”¨é€”ãŒãªã„ã®ã§ãã®ã¾ã¾æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb36"><pre
  class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solveCosine_Hardclip():</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    tau, x0, x1, x2 <span class="op">=</span> sympy.symbols(<span class="st">&quot;Ï„, x_0, x_1, x_2&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;--- Term 1&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    h_cos <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    exprN <span class="op">=</span> <span class="op">-</span>h_cos</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    exprP <span class="op">=</span> h_cos</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    exprL <span class="op">=</span> h_cos <span class="op">*</span> (x0 <span class="op">+</span> tau <span class="op">*</span> (x1 <span class="op">-</span> x0))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> (<span class="op">-</span>x0 <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (x1 <span class="op">-</span> x0)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> (<span class="op">-</span>x0 <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> (x1 <span class="op">-</span> x0)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    J <span class="op">=</span> sympy.integrate</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    cases <span class="op">=</span> [</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span>sympy.Rational(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        J(exprN, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprL, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        J(exprN, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprL, [tau, a, b]) <span class="op">+</span> J(exprP, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprN, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, <span class="dv">1</span>]),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprP, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>        J(exprP, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprL, [tau, b, a]) <span class="op">+</span> J(exprN, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        J(exprP, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprL, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        sympy.Rational(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, expr <span class="kw">in</span> <span class="bu">enumerate</span>(cases):</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;-- Case </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.expand(expr)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.cancel(expr)</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.trigsimp(expr)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(expr, end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;--- Term 2&quot;</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    h_cos <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> sympy.cos(sympy.pi <span class="op">*</span> tau)) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    exprN <span class="op">=</span> <span class="op">-</span>h_cos</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    exprP <span class="op">=</span> h_cos</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    exprL <span class="op">=</span> h_cos <span class="op">*</span> (x1 <span class="op">+</span> tau <span class="op">*</span> (x2 <span class="op">-</span> x1))</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> (<span class="op">-</span>x1 <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> (x2 <span class="op">-</span> x1)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> (<span class="op">-</span>x1 <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> (x2 <span class="op">-</span> x1)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    J <span class="op">=</span> sympy.integrate</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    cases <span class="op">=</span> [</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span>sympy.Rational(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>        J(exprN, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprL, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>        J(exprN, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprL, [tau, a, b]) <span class="op">+</span> J(exprP, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, a]) <span class="op">+</span> J(exprN, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, <span class="dv">1</span>]),</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>        J(exprL, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprP, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>        J(exprP, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprL, [tau, b, a]) <span class="op">+</span> J(exprN, [tau, a, <span class="dv">1</span>]),</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>        J(exprP, [tau, <span class="dv">0</span>, b]) <span class="op">+</span> J(exprL, [tau, b, <span class="dv">1</span>]),</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>        sympy.Rational(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, expr <span class="kw">in</span> <span class="bu">enumerate</span>(cases):</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;-- Case </span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.expand(expr)</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.cancel(expr)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        expr <span class="op">=</span> sympy.trigsimp(expr)</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(expr, end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
  <p>ä»¥ä¸‹ã¯ ADAA ã®å®Ÿè£…ã¸ã®ãƒªãƒ³ã‚¯ã§ã™ã€‚å‹•ä½œç¢ºèªã®ãŸã‚ã« SymPy
  ã‹ã‚‰ã®å‡ºåŠ›ã‚’ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼ã—ãŸã ã‘ãªã®ã§è¨ˆç®—åŠ¹ç‡ãŒæ‚ªã„ã§ã™ã€‚æ‰‹ã§ã®å¼ã®æ•´ç†ã¯ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ‚ªã„ã¨åˆ¤æ–­ã—ã¦ä¸­æ–­ã—ã¾ã—ãŸã€‚</p>
  <ul>
  <li>https://github.com/ryukau/filter_notes/blob/e4608cfa031213dcf794204dcc5ada389946bbc3/antiderivative_antialiasing/adaa_parkermod.py#L195-L403</li>
  </ul>
  <h2 id="é€£ç¶šé ˜åŸŸã§ã®-iir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•"><a
  href="#é€£ç¶šé ˜åŸŸã§ã®-iir-ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•" class="header-anchor"
  aria-hidden="true">é€£ç¶šé ˜åŸŸã§ã® IIR ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿‘ä¼¼ã™ã‚‹æ‰‹æ³•</a></h2>
  <p>La Pastina ã‚‰ã«ã‚ˆã£ã¦ãƒãƒ¼ãƒ‰ã‚¯ãƒªãƒƒãƒ—ã®ã¨ãã®å®Ÿè£…ä¾‹ãŒ Matlab
  ã®ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å…¥æ‰‹ã§ãã¾ã™ã€‚</p>
  <ul>
  <li><a href="http://www.dangelo.audio/dafx2021-aaiir.html">Companion
  page for â€œArbitrary-Order IIR Antiderivative Antialiasingâ€</a></li>
  </ul>
  <p>ä»¥ä¸‹ã¯ Python 3
  ã¸ç§»æ¤ã—ãŸã‚³ãƒ¼ãƒ‰ã¸ã®ãƒªãƒ³ã‚¯ã§ã™ã€‚ä»–ã®æ‰‹æ³•ã®è«–æ–‡é€šã‚Šã®å®Ÿè£…ã¨æ··ã–ã£ã¦ã„ã¾ã™ã€‚
  La Pastina ã‚‰ã«é–¢é€£ã™ã‚‹å®Ÿè£…ã¯é–¢æ•°åã« <code>aaiir</code>
  ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚</p>
  <ul>
  <li><a
  href="https://github.com/ryukau/filter_notes/blob/master/antiderivative_antialiasing/adaa_othermethods.py">filter_notes/antiderivative_antialiasing/adaa_othermethods.py
  at master Â· ryukau/filter_notes Â· GitHub</a></li>
  </ul>
  <h2 id="ãã®ä»–"><a href="#ãã®ä»–" class="header-anchor"
  aria-hidden="true">ãã®ä»–</a></h2>
  <h3 id="c-ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª"><a
  href="#c-ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª" class="header-anchor"
  aria-hidden="true">C++ ã§ä½¿ãˆã‚‹æ•°å­¦ç‰¹æ®Šé–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></h3>
  <h4 id="boost"><a href="#boost" class="header-anchor"
  aria-hidden="true">Boost</a></h4>
  <p>å®šç•ªã§ã™ãŒã€å¤§ãã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã®ã§æ°—è»½ã«ã¯ä½¿ãˆãªã„å°è±¡ãŒã‚ã‚Šã¾ã™ã€‚</p>
  <ul>
  <li><a
  href="https://www.boost.org/doc/libs/1_87_0/libs/math/doc/html/special.html">ChapterÂ 8.Â Special
  Functions - 1.87.0</a></li>
  </ul>
  <h4 id="cephes"><a href="#cephes" class="header-anchor"
  aria-hidden="true">Cephes</a></h4>
  <p>Cephes ã¯ C
  è¨€èªã§æ›¸ã‹ã‚ŒãŸæ•°å­¦é–¢æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚å®Ÿè£…ãŒç°¡æ½”ãªã®ã§æ¯”è¼ƒçš„æ‰‹è»½ã«ç§»æ¤ã§ãã¾ã™ã€‚ã‚¬ãƒ³ãƒé–¢æ•°ã®å®Ÿè£…
  <code>gamma</code> ã¨ <code>lgam</code> ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
  <code>sgngam</code> ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã§æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</p>
  <ul>
  <li><a href="https://netlib.org/cephes/">Cephes - netlib.org</a></li>
  <li><a href="http://www.moshier.net/#Cephes">Cephes -
  www.moshier.net</a></li>
  </ul>
  <p>Cephes ã® Windows ä¸Šã§ã® ãƒ“ãƒ«ãƒ‰ã¯ã‚„ã‚„ç‹¬ç‰¹ã§ã€ cl.exe ã®
  <code>/c</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã—ãªã„ã¨å‹•ãã¾ã›ã‚“ã€‚
  <code>/c</code>
  ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãªã„ã€ã‚ã‚‹ã„ã¯ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã†ã¨ã€ cl.exe
  ãŒæä¾›ã™ã‚‹æ•°å­¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒªãƒ³ã‚¯ã•ã‚Œã‚‹ã®ã§ <code>sin</code> ã‚„
  <code>exp</code> ã¨ã„ã£ãŸé–¢æ•°åãŒç«¶åˆã—ã¦ã—ã¾ã„ã¾ã™ã€‚</p>
  <p>CMake ã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã¨ãã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã® <code>cephes</code>
  ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå‚è€ƒã«ãªã‚Šã¾ã™ã€‚</p>
  <ul>
  <li><a href="https://github.com/google-deepmind/torch-cephes">GitHub -
  google-deepmind/torch-cephes: Cephes Mathematical Functions library
  wrapped for Torch</a></li>
  </ul>
  <h4 id="polylogarithm"><a href="#polylogarithm" class="header-anchor"
  aria-hidden="true">Polylogarithm</a></h4>
  <p>Polylogarithm (<span
  class="math inline">\(\operatorname{Li}_n\)</span>) ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®
  C++ ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ãˆã¾ã™ã€‚ <a
  href="https://en.wikipedia.org/wiki/Clausen_function">Clausen
  function</a> (<span
  class="math inline">\(\operatorname{Cl}_n\)</span>) ã¨
  Glaisherâ€“Clausen function (<span
  class="math inline">\(\operatorname{Sl}_n\)</span>)
  ã®å®Ÿè£…ã‚‚ã‚ã‚Šã¾ã™ã€‚</p>
  <ul>
  <li><a href="https://github.com/Expander/polylogarithm">GitHub -
  Expander/polylogarithm: Implementation of polylogarithms in
  C/C++/Fortran</a></li>
  </ul>
  <h3 id="javascript-ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°"><a
  href="#javascript-ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°" class="header-anchor"
  aria-hidden="true">JavaScript ã§ã®æ•°å­¦ç‰¹æ®Šé–¢æ•°</a></h3>
  <p>ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã® JavaScript ã§æ•°å­¦ç‰¹æ®Šé–¢æ•°ã‚’ä½¿ã„ãŸã„ã¨ãã¯ <a
  href="https://emscripten.org/">emscripten</a> ã‚’ä½¿ã†ã¨æ¥½ã§ã™ã€‚
  <code>emcc</code> ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ <code>-sUSE_BOOST_HEADERS=1</code>
  ã‚’æŒ‡å®šã™ã‚Œã° Boost ã¨ç°¡å˜ã«ãƒªãƒ³ã‚¯ã§ãã¾ã™ã€‚</p>
  <p>ä»¥ä¸‹ã¯ C++ ã§æ›¸ã‹ã‚ŒãŸãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã™ã€‚</p>
  <div class="sourceCode" id="cb37"><pre
  class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">// test.cpp</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;boost/math/special_functions/gamma.hpp&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;boost/version.hpp&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;emscripten/bind.h&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string&gt;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> emscripten<span class="op">;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co">// ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ™‚ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå‚ç…§ã§ãã‚‹ã¨ä¾¿åˆ©ã€‚</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">std::</span>string boost_version<span class="op">()</span> <span class="op">{</span> <span class="cf">return</span> <span class="ex">BOOST_</span>LIB_VERSION<span class="op">;</span> <span class="op">}</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>EMSCRIPTEN_BINDINGS<span class="op">(</span>BoostMath<span class="op">)</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  function<span class="op">(</span><span class="st">&quot;boost_version&quot;</span><span class="op">,</span> <span class="op">&amp;</span>boost_version<span class="op">);</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ã‚¬ãƒ³ãƒé–¢æ•°ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ä¾‹ã€‚ JavaScript ã«ã‚ã‚ã›ã¦ double ã‚’æŒ‡å®šã€‚</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  function<span class="op">(</span><span class="st">&quot;gamma_p&quot;</span><span class="op">,</span> <span class="op">&amp;</span><span class="ex">boost::</span>math::gamma_p<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  function<span class="op">(</span><span class="st">&quot;gamma_q&quot;</span><span class="op">,</span> <span class="op">&amp;</span><span class="ex">boost::</span>math::gamma_q<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  function<span class="op">(</span><span class="st">&quot;tgamma_lower&quot;</span><span class="op">,</span> <span class="op">&amp;</span><span class="ex">boost::</span>math::tgamma_lower<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  function<span class="op">(</span><span class="st">&quot;tgamma&quot;</span><span class="op">,</span> <span class="op">&amp;</span><span class="ex">boost::</span>math::tgamma<span class="op">&lt;</span><span class="dt">double</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;);</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
  <p>ä¸Šã®ã‚³ãƒ¼ãƒ‰ã‚’ <code>text.cpp</code>
  ã¨ã—ã¦ä¿å­˜ã—ãŸã‚ã¨ã«ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ JavaScript
  ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ã€‚</p>
  <div class="sourceCode" id="cb38"><pre
  class="sourceCode ps1"><code class="sourceCode powershell"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PowerShell</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>emcc                    `</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>lembind              `</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>O3                   `</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>sWASM<span class="op">=</span><span class="dv">0</span>              `</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>sUSE_BOOST_HEADERS<span class="op">=</span><span class="dv">1</span> `</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>sMODULARIZE<span class="op">=</span><span class="dv">1</span>        `</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>sEXPORT_ES6<span class="op">=</span><span class="dv">1</span>        `</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>sPOLYFILL<span class="op">=</span><span class="dv">1</span>          `</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>o test<span class="op">.</span><span class="fu">js</span>            `</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">../</span>test<span class="op">.</span><span class="fu">cpp</span></span></code></pre></div>
  <p><code>emcc</code>
  ã®ä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
  <ul>
  <li><a
  href="https://emscripten.org/docs/tools_reference/settings_reference.html#use-boost-headers">Emscripten
  Compiler Settings â€” Emscripten 4.0.0-git (dev) documentation</a></li>
  <li><a
  href="https://emscripten.org/docs/tools_reference/emcc.html">Emscripten
  Compiler Frontend (emcc) â€” Emscripten 4.0.0-git (dev)
  documentation</a></li>
  </ul>
  <p>ä¸Šã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ <code>test.js</code>
  ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã¯ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ä½¿ç”¨ä¾‹ã§ã™ã€‚</p>
  <div class="sourceCode" id="cb39"><pre
  class="sourceCode html"><code class="sourceCode html"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!doctype</span> html<span class="dt">&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> type=</span><span class="st">&quot;module&quot;</span><span class="dt">&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> BoostMath <span class="im">from</span> <span class="st">&quot;./build/somemath.js&quot;</span><span class="op">;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">async</span> <span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> bmath <span class="op">=</span> <span class="cf">await</span> <span class="fu">BoostMath</span>()<span class="op">;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`boost_version: </span><span class="sc">${</span>bmath<span class="op">.</span><span class="fu">boost_version</span>()<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`gamma_p result: </span><span class="sc">${</span>bmath<span class="op">.</span><span class="fu">gamma_p</span>(<span class="dv">2</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`gamma_q result: </span><span class="sc">${</span>bmath<span class="op">.</span><span class="fu">gamma_q</span>(<span class="dv">2</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`tgamma_lower result: </span><span class="sc">${</span>bmath<span class="op">.</span><span class="fu">tgamma_lower</span>(<span class="dv">2</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`tgamma result: </span><span class="sc">${</span>bmath<span class="op">.</span><span class="fu">tgamma</span>(<span class="dv">2</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">main</span>()<span class="op">;</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
  <p>ã‚ã¨ã¯ä¸Šã® HTML ã‚’ <code>test.html</code> ãªã©ã¨ä¿å­˜ã—ã¦ã€
  <code>test.js</code> ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ãŸã‚ã¨ã€
  <code>python3 -m http.server</code> ãªã©ã‚’ä½¿ãˆã°ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚
  <code>test.html</code>
  ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å‹•ä½œã•ã›ã‚‹æ–¹æ³•ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯å…ˆã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚</p>
  <ul>
  <li><a
  href="https://developer.mozilla.org/en-US/docs/Learn_web_development/Howto/Tools_and_setup/set_up_a_local_testing_server">How
  do you set up a local testing server? - Learn web development |
  MDN</a></li>
  </ul>
  <h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="header-anchor"
  aria-hidden="true">å‚è€ƒæ–‡çŒ®</a></h2>
  <ul>
  <li>Parker, J. D., Zavalishin, V., &amp; Le Bivic, E. (2016,
  September). <a
  href="https://dafx16.vutbr.cz/dafxpapers/20-DAFx-16_paper_41-PN.pdf">Reducing
  the aliasing of nonlinear waveshaping using continuous-time
  convolution</a>. In Proc. Int. Conf. Digital Audio Effects (DAFx-16),
  Brno, Czech Republic (pp.Â 137-144).</li>
  <li>Bilbao, S., Esqueda, F., Parker, J. D., &amp; VÃ¤limÃ¤ki, V. (2017).
  <a
  href="https://drive.google.com/file/d/1SaqbMpxitC8QECkF3OfzHu7cDCnmpzY7/view">Antiderivative
  antialiasing for memoryless nonlinearities</a>. IEEE Signal Processing
  Letters, 24(7), 1049-1053.</li>
  <li>La Pastina, P. P., Dâ€™Angelo, S., &amp; Gabrielli, L. (2021,
  September). <a
  href="https://www.researchgate.net/profile/Stefano-Dangelo/publication/354574545_Arbitrary-Order_IIR_Antiderivative_Antialiasing/links/61408f9c578238365b0981c7/Arbitrary-Order-IIR-Antiderivative-Antialiasing.pdf">Arbitrary-order
  IIR antiderivative antialiasing</a>. In 2021 24th International
  Conference on Digital Audio Effects (DAFx) (pp.Â 9-16). IEEE.</li>
  <li><a
  href="https://github.com/jatinchowdhury18/ADAA?tab=readme-ov-file">GitHub
  - jatinchowdhury18/ADAA: Experiments with Antiderivative
  Antialiasing</a></li>
  </ul>
    <footer>
    <a href="../index.html">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«æˆ»ã‚‹</a>
  </footer>
</body>

</html>
